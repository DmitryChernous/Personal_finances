# –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ –Ω–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫—É

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2026-01-25  
**–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞:** TECHNICAL_SPECIFICATION.md, EXPERT_REVIEW.md  
**–¶–µ–ª—å:** –î–µ—Ç–∞–ª—å–Ω—ã–µ –∑–∞–¥–∞—á–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å –ø–æ–ª–Ω—ã–º–∏ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è–º–∏

---

## –û–±—â–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥—É–ª–∏: `Constants.js`, `ErrorHandler.js`, `DateUtils.js`, `Sheets.js`
- –°–ª–µ–¥–æ–≤–∞—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω–∞–º –ø—Ä–æ–µ–∫—Ç–∞: –ø—Ä–µ—Ñ–∏–∫—Å `pf`, –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å `_`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å i18n –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –≤–æ –≤—Å–µ—Ö –ø—É–±–ª–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏—è—Ö
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —á–µ—Ä–µ–∑ `ErrorHandler.js`

### –°—Ç–∞–Ω–¥–∞—Ä—Ç—ã –∫–æ–¥–∞
- JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤ –Ω–∞—á–∞–ª–µ —Ñ—É–Ω–∫—Ü–∏–π
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `pfLogError_`, `pfLogWarning_`, `pfLogInfo_`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç –∏–∑ `Constants.js` –≤–º–µ—Å—Ç–æ –º–∞–≥–∏—á–µ—Å–∫–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–¥–æ–±–∞–≤–∏—Ç—å –≤ `Tests.js`)
- –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ edge cases (–ø—É—Å—Ç—ã–µ –¥–∞–Ω–Ω—ã–µ, –≥—Ä–∞–Ω–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)

---

## –≠—Ç–∞–ø 1: –ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ üî¥

**ID:** TASK-001  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–Ω—ã–π  
**–û—Ü–µ–Ω–∫–∞:** 4-6 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 1.1: –†–∞—Å—à–∏—Ä–∏—Ç—å Schema.js –¥–ª—è Budgets

**–§–∞–π–ª:** `src/Schema.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É `PF_BUDGETS_SCHEMA` –ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Å—Ö–µ–º–∞–º–∏
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–ª–æ–Ω–æ–∫:
   ```javascript
   var PF_BUDGETS_SCHEMA = {
     sheetKey: 'budgets',
     columns: [
       { key: 'Category', required: true },
       { key: 'Subcategory', required: false },
       { key: 'Period', required: true, allowed: ['month', 'year'] },
       { key: 'PeriodValue', required: true },
       { key: 'Amount', required: true },
       { key: 'Fact', required: false }, // Calculated
       { key: 'Remaining', required: false }, // Calculated
       { key: 'Status', required: false }, // Calculated
       { key: 'PercentUsed', required: false }, // Calculated
       { key: 'Active', required: false },
       { key: 'Description', required: false }
     ]
   };
   ```

**–î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ —Ñ–æ—Ä–º–∞—Ç, —á—Ç–æ –∏ `PF_TRANSACTIONS_SCHEMA`
- `PeriodValue` —Ñ–æ—Ä–º–∞—Ç: `YYYY-MM` –¥–ª—è –º–µ—Å—è—Ü–∞, `YYYY` –¥–ª—è –≥–æ–¥–∞
- `Fact`, `Remaining`, `Status`, `PercentUsed` ‚Äî –≤—ã—á–∏—Å–ª—è–µ–º—ã–µ –ø–æ–ª—è (—Ñ–æ—Ä–º—É–ª—ã –∏–ª–∏ —Å–∫—Ä–∏–ø—Ç)

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `Period` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ —Å–ø–∏—Å–∫–µ `['month', 'year']`
- `PeriodValue` –¥–æ–ª–∂–µ–Ω —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç—É (—Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: `^\d{4}(-\d{2})?$`)
- `Amount` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Å—Ö–µ–º–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é —Ñ–æ—Ä–º–∞—Ç–∞ `PeriodValue`

---

### –ó–∞–¥–∞—á–∞ 1.2: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è –±—é–¥–∂–µ—Ç–æ–≤

**–§–∞–π–ª:** `src/Constants.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Å—Ç–∞—Ç—É—Å–æ–≤ –±—é–¥–∂–µ—Ç–∞:
   ```javascript
   var PF_BUDGET_STATUS = {
     OK: 'ok',
     WARNING: 'warning',
     EXCEEDED: 'exceeded'
   };
   ```

2. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø–µ—Ä–∏–æ–¥–æ–≤:
   ```javascript
   var PF_BUDGET_PERIOD = {
     MONTH: 'month',
     YEAR: 'year'
   };
   ```

3. –î–æ–±–∞–≤–∏—Ç—å –ø–æ—Ä–æ–≥–∏ –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤:
   ```javascript
   var PF_BUDGET_WARNING_THRESHOLD = 0.20; // 20% –æ—Å—Ç–∞—Ç–∫–∞ –æ—Ç –ø–ª–∞–Ω–∞
   ```

**–î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ —Å—Ç–∏–ª—å, —á—Ç–æ –∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã
- –î–æ–±–∞–≤–∏—Ç—å JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏

---

### –ó–∞–¥–∞—á–∞ 1.3: –î–æ–±–∞–≤–∏—Ç—å i18n –∫–ª—é—á–∏ –¥–ª—è Budgets

**–§–∞–π–ª:** `src/I18n.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å `BUDGETS: 'budgets'` –≤ `PF_SHEET_KEYS`
2. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –ª–∏—Å—Ç–∞:
   ```javascript
   sheet: {
     budgets: '–ë—é–¥–∂–µ—Ç—ã' // RU
     budgets: 'Budgets' // EN
   }
   ```
3. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –∫–æ–ª–æ–Ω–æ–∫:
   ```javascript
   columns: {
     Period: '–ü–µ—Ä–∏–æ–¥' / 'Period',
     PeriodValue: '–ó–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞' / 'Period Value',
     Fact: '–§–∞–∫—Ç' / 'Fact',
     Remaining: '–û—Å—Ç–∞—Ç–æ–∫' / 'Remaining',
     PercentUsed: '% –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è' / '% Used'
   }
   ```
4. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –º–µ–Ω—é:
   ```javascript
   menu: {
     update_budgets: '–û–±–Ω–æ–≤–∏—Ç—å –±—é–¥–∂–µ—Ç—ã' / 'Update budgets'
   }
   ```
5. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è —Å—Ç–∞—Ç—É—Å–æ–≤:
   ```javascript
   budget_status: {
     ok: '–í –Ω–æ—Ä–º–µ' / 'OK',
     warning: '–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ' / 'Warning',
     exceeded: '–ü—Ä–µ–≤—ã—à–µ–Ω' / 'Exceeded'
   }
   ```

**–î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –°–ª–µ–¥–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ i18n
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª—é—á–∏ –≤–∏–¥–∞ `sheet.budgets`, `columns.Period`, `menu.update_budgets`

---

### –ó–∞–¥–∞—á–∞ 1.4: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å Budgets.js

**–§–∞–π–ª:** `src/Budgets.js` (–Ω–æ–≤—ã–π)

**–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

#### 1.4.1. `pfInitializeBudgets_(ss)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏—Å—Ç–∞ Budgets –ø—Ä–∏ Setup

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ss` (Spreadsheet) ‚Äî —Ç–∞–±–ª–∏—Ü–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ù–∞–π—Ç–∏ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –ª–∏—Å—Ç Budgets —á–µ—Ä–µ–∑ `pfFindOrCreateSheetByKey_(ss, PF_SHEET_KEYS.BUDGETS)`
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ —á–µ—Ä–µ–∑ `pfEnsureHeaderRow_(sheet, PF_BUDGETS_SCHEMA)`
3. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
   - –ó–∞–º–æ—Ä–æ–∑–∏—Ç—å –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ–∫—É
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∞–≤—Ç–æ—Ñ–∏–ª—å—Ç—Ä
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–æ–Ω–∫—É Amount –∫–∞–∫ —á–∏—Å–ª–æ —Å 2 –∑–Ω–∞–∫–∞–º–∏
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–æ–Ω–∫–∏ Fact, Remaining –∫–∞–∫ —á–∏—Å–ª–æ —Å 2 –∑–Ω–∞–∫–∞–º–∏
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–ª–æ–Ω–∫—É PercentUsed –∫–∞–∫ –ø—Ä–æ—Ü–µ–Ω—Ç
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏:
   - `Period`: —Å–ø–∏—Å–æ–∫ `[PF_BUDGET_PERIOD.MONTH, PF_BUDGET_PERIOD.YEAR]`
   - `Category`: –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ Categories (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å named range)
   - `Amount`: —á–∏—Å–ª–æ > 0
   - `PeriodValue`: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ (—Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ)

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –ª–∏—Å—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É —á–µ—Ä–µ–∑ `pfLogError_`
- –ï—Å–ª–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã ‚Äî –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ –ø—Ä–∏ Setup
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

#### 1.4.2. `pfCalculateBudgetFact_(category, subcategory, periodValue, period)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—á–µ—Ç —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö —Ä–∞—Å—Ö–æ–¥–æ–≤/–¥–æ—Ö–æ–¥–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞ –ø–µ—Ä–∏–æ–¥

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `category` (string) ‚Äî –∫–∞—Ç–µ–≥–æ—Ä–∏—è
- `subcategory` (string, optional) ‚Äî –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è
- `periodValue` (string) ‚Äî –∑–Ω–∞—á–µ–Ω–∏–µ –ø–µ—Ä–∏–æ–¥–∞ (`YYYY-MM` –∏–ª–∏ `YYYY`)
- `period` (string) ‚Äî —Ç–∏–ø –ø–µ—Ä–∏–æ–¥–∞ (`month` –∏–ª–∏ `year`)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `number` ‚Äî —Å—É–º–º–∞ —Ñ–∞–∫—Ç–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Transactions
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞—Ç:
   - –î–ª—è `month`: –ø–∞—Ä—Å–∏—Ç—å `periodValue` –∫–∞–∫ `YYYY-MM`, –ø–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–π –∏ –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
   - –î–ª—è `year`: –ø–∞—Ä—Å–∏—Ç—å `periodValue` –∫–∞–∫ `YYYY`, –ø–æ–ª—É—á–∏—Ç—å 01.01.YYYY –∏ 31.12.YYYY
3. –ü–æ–ª—É—á–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –∫–æ–ª–æ–Ω–æ–∫: Category, Subcategory, Amount, Type, Status, Date
4. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ Transactions (–∫—ç—à–∏—Ä–æ–≤–∞—Ç—å `getLastRow()`)
5. –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:
   - –î–∞—Ç–∞ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ
   - Category —Å–æ–≤–ø–∞–¥–∞–µ—Ç
   - Subcategory —Å–æ–≤–ø–∞–¥–∞–µ—Ç (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞)
   - Status = `PF_TRANSACTION_STATUS.OK`
   - Type = `PF_TRANSACTION_TYPE.EXPENSE` (–¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤) –∏–ª–∏ `PF_TRANSACTION_TYPE.INCOME` (–¥–ª—è –¥–æ—Ö–æ–¥–æ–≤)
6. –°—É–º–º–∏—Ä–æ–≤–∞—Ç—å Amount –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ `periodValue` –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Äî –≤–µ—Ä–Ω—É—Ç—å 0 –∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Äî –≤–µ—Ä–Ω—É—Ç—å 0
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö ‚Äî –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É –∏ –≤–µ—Ä–Ω—É—Ç—å 0

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å `getLastRow()` –ø–µ—Ä–µ–¥ —Ü–∏–∫–ª–æ–º
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getValues()` –æ–¥–∏–Ω —Ä–∞–∑ –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö `getValue()`

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –¢–µ—Å—Ç —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º `periodValue`
- –¢–µ—Å—Ç —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π
- –¢–µ—Å—Ç —Å –ø—É—Å—Ç—ã–º–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º–∏

---

#### 1.4.3. `pfGetBudgetStatus_(planAmount, factAmount)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –±—é–¥–∂–µ—Ç–∞

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `planAmount` (number) ‚Äî –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—É–º–º–∞
- `factAmount` (number) ‚Äî —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∞—è —Å—É–º–º–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `string` ‚Äî —Å—Ç–∞—Ç—É—Å (`PF_BUDGET_STATUS.OK`, `PF_BUDGET_STATUS.WARNING`, `PF_BUDGET_STATUS.EXCEEDED`)

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ï—Å–ª–∏ `factAmount > planAmount` ‚Üí `EXCEEDED`
2. –í—ã—á–∏—Å–ª–∏—Ç—å –æ—Å—Ç–∞—Ç–æ–∫: `remaining = planAmount - factAmount`
3. –í—ã—á–∏—Å–ª–∏—Ç—å –ø—Ä–æ—Ü–µ–Ω—Ç –æ—Å—Ç–∞—Ç–∫–∞: `remainingPercent = remaining / planAmount`
4. –ï—Å–ª–∏ `remainingPercent <= PF_BUDGET_WARNING_THRESHOLD` ‚Üí `WARNING`
5. –ò–Ω–∞—á–µ ‚Üí `OK`

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ `planAmount <= 0` ‚Äî –≤–µ—Ä–Ω—É—Ç—å `EXCEEDED` –∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- –ï—Å–ª–∏ `factAmount < 0` ‚Äî –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (–Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç: fact < plan * 0.8 ‚Üí OK
- –¢–µ—Å—Ç: fact >= plan * 0.8 –∏ fact <= plan ‚Üí WARNING
- –¢–µ—Å—Ç: fact > plan ‚Üí EXCEEDED
- –¢–µ—Å—Ç: plan = 0 ‚Üí EXCEEDED

---

#### 1.4.4. `pfUpdateBudgetCalculations_(ss)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Ä–∞—Å—á–µ—Ç–Ω—ã—Ö –ø–æ–ª–µ–π –≤ –ª–∏—Å—Ç–µ Budgets

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ss` (Spreadsheet, optional) ‚Äî —Ç–∞–±–ª–∏—Ü–∞ (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `getActiveSpreadsheet()`)

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Budgets
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ª–∏—Å—Ç —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ (lastRow > 1)
3. –ü–æ–ª—É—á–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –∫–æ–ª–æ–Ω–æ–∫: Category, Subcategory, Period, PeriodValue, Amount, Fact, Remaining, Status, PercentUsed
4. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å `getLastRow()` –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
5. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –±—é–¥–∂–µ—Ç–∞:
   - –ï—Å–ª–∏ `Active = false` –∏–ª–∏ –ø—É—Å—Ç–æ ‚Äî –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å
   - –í—ã—á–∏—Å–ª–∏—Ç—å Fact —á–µ—Ä–µ–∑ `pfCalculateBudgetFact_`
   - –í—ã—á–∏—Å–ª–∏—Ç—å Remaining = Amount - Fact
   - –í—ã—á–∏—Å–ª–∏—Ç—å Status —á–µ—Ä–µ–∑ `pfGetBudgetStatus_`
   - –í—ã—á–∏—Å–ª–∏—Ç—å PercentUsed = (Fact / Amount) * 100
   - –ó–∞–ø–∏—Å–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –∫–æ–ª–æ–Ω–∫–∏
6. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
   - –ü–æ–¥—Å–≤–µ—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å `Status = EXCEEDED` –∫—Ä–∞—Å–Ω—ã–º —Ü–≤–µ—Ç–æ–º
   - –ü–æ–¥—Å–≤–µ—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫–∏ —Å `Status = WARNING` –∂–µ–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –ª–∏—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É —á–µ—Ä–µ–∑ `pfCreateErrorResponse_`
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏/–∑–∞–ø–∏—Å–∏ ‚Äî –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Å–æ —Å–ª–µ–¥—É—é—â–µ–π —Å—Ç—Ä–æ–∫–∏
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –≤ —Ä–∞—Å—á–µ—Ç–µ Fact ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Fact = 0 –∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `setValues()` –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –≤–º–µ—Å—Ç–æ –∑–∞–ø–∏—Å–∏ –ø–æ –æ–¥–Ω–æ–π —è—á–µ–π–∫–µ
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ Transactions –æ–¥–∏–Ω —Ä–∞–∑ –¥–ª—è –≤—Å–µ—Ö –±—é–¥–∂–µ—Ç–æ–≤

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –±—é–¥–∂–µ—Ç–∞–º–∏
- –¢–µ—Å—Ç —Å –ø—É—Å—Ç—ã–º –ª–∏—Å—Ç–æ–º
- –¢–µ—Å—Ç —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –≤ –±—é–¥–∂–µ—Ç–∞—Ö
- –¢–µ—Å—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–º–Ω–æ–≥–æ –±—é–¥–∂–µ—Ç–æ–≤)

---

#### 1.4.5. `pfUpdateBudgetCalculations()` (–ø—É–±–ª–∏—á–Ω–∞—è)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—É–±–ª–∏—á–Ω–∞—è –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è –≤—ã–∑–æ–≤–∞ –∏–∑ –º–µ–Ω—é

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –í—ã–∑–≤–∞—Ç—å `pfUpdateBudgetCalculations_(SpreadsheetApp.getActiveSpreadsheet())`
2. –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `pfHandleError_` –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫
- –ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

---

### –ó–∞–¥–∞—á–∞ 1.5: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å Budgets –≤ Setup.js

**–§–∞–π–ª:** `src/Setup.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –í —Ñ—É–Ω–∫—Ü–∏–∏ `pfRunSetup_()` –¥–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤:
   ```javascript
   pfInitializeBudgets_(ss);
   ```

2. –í —Ñ—É–Ω–∫—Ü–∏–∏ `pfApplyLocalization_()` –¥–æ–±–∞–≤–∏—Ç—å:
   ```javascript
   pfFindOrCreateSheetByKey_(ss, PF_SHEET_KEYS.BUDGETS);
   ```

**–î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –≤—ã–∑–æ–≤ –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –¥—Ä—É–≥–∏—Ö –ª–∏—Å—Ç–æ–≤
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ª–∏—Å—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏–º–µ–Ω–µ–º (–ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–º)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ó–∞–ø—É—Å—Ç–∏—Ç—å Setup –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ Budgets
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏—é –∏–º–µ–Ω–∏ –ª–∏—Å—Ç–∞

---

### –ó–∞–¥–∞—á–∞ 1.6: –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é Budgets –≤ Reports.js

**–§–∞–π–ª:** `src/Reports.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Å–µ–∫—Ü–∏—é "–ë—é–¥–∂–µ—Ç—ã" –≤ —Ñ—É–Ω–∫—Ü–∏—é `pfInitializeReports_()`
2. –†–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –ø–æ—Å–ª–µ —Å–µ–∫—Ü–∏–∏ "–ú–µ—Å—è—á–Ω—ã–π cashflow"

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–µ–∫—Ü–∏–∏:**
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: "–ë—é–¥–∂–µ—Ç—ã (—Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü)" / "Budgets (Current Month)"
- –¢–∞–±–ª–∏—Ü–∞ —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏:
  - –ö–∞—Ç–µ–≥–æ—Ä–∏—è
  - –ü–ª–∞–Ω
  - –§–∞–∫—Ç
  - –û—Å—Ç–∞—Ç–æ–∫
  - –°—Ç–∞—Ç—É—Å
  - % –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü –≤ —Ñ–æ—Ä–º–∞—Ç–µ `YYYY-MM`
2. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Budgets
3. –ù–∞–π—Ç–∏ –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –±—é–¥–∂–µ—Ç—ã –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –±—é–¥–∂–µ—Ç–∞:
   - –í—ã—á–∏—Å–ª–∏—Ç—å Fact —á–µ—Ä–µ–∑ `pfCalculateBudgetFact_`
   - –í—ã—á–∏—Å–ª–∏—Ç—å Remaining, Status, PercentUsed
   - –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –≤ —Ç–∞–±–ª–∏—Ü—É
5. –ó–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Reports –ª–∏—Å—Ç
6. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
   - –ü–æ–¥—Å–≤–µ—Ç–∏—Ç—å –ø—Ä–µ–≤—ã—à–µ–Ω–Ω—ã–µ –±—é–¥–∂–µ—Ç—ã
   - –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —á–∏—Å–ª–∞ –∏ –ø—Ä–æ—Ü–µ–Ω—Ç—ã

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –ª–∏—Å—Ç Budgets –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–µ–∫—Ü–∏—é
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ ‚Äî –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –±—é–¥–∂–µ—Ç

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –±—é–¥–∂–µ—Ç–∞–º–∏
- –¢–µ—Å—Ç —Å –ø—É—Å—Ç—ã–º –ª–∏—Å—Ç–æ–º Budgets
- –¢–µ—Å—Ç —Å –±—é–¥–∂–µ—Ç–∞–º–∏ –Ω–∞ —Ä–∞–∑–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã

---

### –ó–∞–¥–∞—á–∞ 1.7: –î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–∂–µ—Ç Budgets –≤ Dashboard.js

**–§–∞–π–ª:** `src/Dashboard.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å KPI –∫–∞—Ä—Ç–æ—á–∫–∏ –¥–ª—è –±—é–¥–∂–µ—Ç–æ–≤
2. –î–æ–±–∞–≤–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Å –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ–º –±—é–¥–∂–µ—Ç–∞

**KPI –∫–∞—Ä—Ç–æ—á–∫–∏:**
- "–ë—é–¥–∂–µ—Ç–æ–≤ –ø—Ä–µ–≤—ã—à–µ–Ω–æ" ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –±—é–¥–∂–µ—Ç–æ–≤ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º EXCEEDED
- "–°—Ä–µ–¥–Ω–∏–π % –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è" ‚Äî —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–æ—Ü–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –±—é–¥–∂–µ—Ç–æ–≤

**–°–ø–∏—Å–æ–∫ –ø—Ä–µ–≤—ã—à–µ–Ω–Ω—ã—Ö –±—é–¥–∂–µ—Ç–æ–≤:**
- –ó–∞–≥–æ–ª–æ–≤–æ–∫: "–ü—Ä–µ–≤—ã—à–µ–Ω–Ω—ã–µ –±—é–¥–∂–µ—Ç—ã" / "Exceeded Budgets"
- –¢–∞–±–ª–∏—Ü–∞: –ö–∞—Ç–µ–≥–æ—Ä–∏—è, –ü–ª–∞–Ω, –§–∞–∫—Ç, –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü
2. –í—ã–∑–≤–∞—Ç—å `pfUpdateBudgetCalculations_()` –¥–ª—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
3. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –±—é–¥–∂–µ—Ç—ã —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
4. –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –±—é–¥–∂–µ—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º EXCEEDED
5. –í—ã—á–∏—Å–ª–∏—Ç—å KPI
6. –ó–∞–ø–∏—Å–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Dashboard –ª–∏—Å—Ç

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –Ω–µ—Ç –±—é–¥–∂–µ—Ç–æ–≤ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö"
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ ‚Äî –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ–∫–∞–∑–∞—Ç—å –ø—É—Å—Ç—É—é —Ç–∞–±–ª–∏—Ü—É

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å –ø—Ä–µ–≤—ã—à–µ–Ω–Ω—ã–º–∏ –±—é–¥–∂–µ—Ç–∞–º–∏
- –¢–µ—Å—Ç –±–µ–∑ –ø—Ä–µ–≤—ã—à–µ–Ω–Ω—ã—Ö –±—é–¥–∂–µ—Ç–æ–≤
- –¢–µ—Å—Ç —Å –ø—É—Å—Ç—ã–º –ª–∏—Å—Ç–æ–º Budgets

---

### –ó–∞–¥–∞—á–∞ 1.8: –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é

**–§–∞–π–ª:** `src/Code.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –í —Ñ—É–Ω–∫—Ü–∏–∏ `onOpen()` –¥–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é:
   ```javascript
   menu.addItem(pfT_('menu.update_budgets'), 'pfUpdateBudgetCalculations');
   ```

2. –†–∞–∑–º–µ—Å—Ç–∏—Ç—å –ø–æ—Å–ª–µ "–û–±–Ω–æ–≤–∏—Ç—å –¥–∞—à–±–æ—Ä–¥"

**–î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å i18n –∫–ª—é—á `menu.update_budgets`
- –§—É–Ω–∫—Ü–∏—è –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—É–±–ª–∏—á–Ω–æ–π (–±–µ–∑ `_`)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—è–≤–ª–µ–Ω–∏–µ –ø—É–Ω–∫—Ç–∞ –º–µ–Ω—é
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –ø—Ä–∏ –∫–ª–∏–∫–µ

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 1

- ‚úÖ –õ–∏—Å—Ç Budgets —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ Setup —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –±—é–¥–∂–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –Ω–∞ –º–µ—Å—è—Ü/–≥–æ–¥
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç (Period, Category, Amount, PeriodValue)
- ‚úÖ –§—É–Ω–∫—Ü–∏—è "–û–±–Ω–æ–≤–∏—Ç—å –±—é–¥–∂–µ—Ç—ã" —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç Fact, Remaining, Status, PercentUsed
- ‚úÖ –°—Ç–∞—Ç—É—Å—ã –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ (ok/warning/exceeded)
- ‚úÖ –í Reports –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å–µ–∫—Ü–∏—è "–ë—é–¥–∂–µ—Ç—ã" —Å –¥–∞–Ω–Ω—ã–º–∏ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
- ‚úÖ –í Dashboard –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è KPI –∏ —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–≤—ã—à–µ–Ω–Ω—ã—Ö –±—é–¥–∂–µ—Ç–æ–≤
- ‚úÖ –ü—Ä–µ–≤—ã—à–µ–Ω–Ω—ã–µ –±—é–¥–∂–µ—Ç—ã –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–º
- ‚úÖ –í—Å–µ —Ç–µ–∫—Å—Ç—ã –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω—ã (RU/EN)
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ Unit-—Ç–µ—Å—Ç—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ Tests.js –∏ –ø—Ä–æ—Ö–æ–¥—è—Ç

---

## –≠—Ç–∞–ø 2: –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ üî¥

**ID:** TASK-002  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ö—Ä–∏—Ç–∏—á–Ω—ã–π  
**–û—Ü–µ–Ω–∫–∞:** 5-7 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 2.1: –†–∞—Å—à–∏—Ä–∏—Ç—å Schema.js –¥–ª—è RecurringTransactions

**–§–∞–π–ª:** `src/Schema.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É `PF_RECURRING_TRANSACTIONS_SCHEMA`
2. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–ª–æ–Ω–æ–∫:
   ```javascript
   var PF_RECURRING_TRANSACTIONS_SCHEMA = {
     sheetKey: 'recurring_transactions',
     columns: [
       { key: 'Name', required: true },
       { key: 'Type', required: true, allowed: ['expense', 'income', 'transfer'] },
       { key: 'Frequency', required: true, allowed: ['weekly', 'monthly', 'quarterly', 'yearly'] },
       { key: 'DayOfMonth', required: false },
       { key: 'DayOfWeek', required: false },
       { key: 'StartDate', required: true },
       { key: 'EndDate', required: false },
       { key: 'Account', required: true },
       { key: 'AccountTo', required: false },
       { key: 'Amount', required: true },
       { key: 'Currency', required: true },
       { key: 'Category', required: false },
       { key: 'Subcategory', required: false },
       { key: 'Merchant', required: false },
       { key: 'Description', required: false },
       { key: 'Active', required: false },
       { key: 'LastCreated', required: false }
     ]
   };
   ```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `Frequency = weekly` ‚Üí `DayOfWeek` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (1-7, –≥–¥–µ 1=–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫)
- `Frequency = monthly/quarterly/yearly` ‚Üí `DayOfMonth` –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω (1-31)
- `EndDate` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å >= `StartDate` –∏–ª–∏ –ø—É—Å—Ç—ã–º
- `DayOfMonth` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 1-31
- `DayOfWeek` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ 1-7

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –ø–æ–ª–µ–π
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —É—Å–ª–æ–≤–Ω—É—é –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å DayOfMonth/DayOfWeek

---

### –ó–∞–¥–∞—á–∞ 2.2: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π

**–§–∞–π–ª:** `src/Constants.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —á–∞—Å—Ç–æ—Ç—ã:
   ```javascript
   var PF_RECURRING_FREQUENCY = {
     WEEKLY: 'weekly',
     MONTHLY: 'monthly',
     QUARTERLY: 'quarterly',
     YEARLY: 'yearly'
   };
   ```

**–î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ—Ç –∂–µ —Å—Ç–∏–ª—å, —á—Ç–æ –∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

---

### –ó–∞–¥–∞—á–∞ 2.3: –î–æ–±–∞–≤–∏—Ç—å i18n –∫–ª—é—á–∏ –¥–ª—è RecurringTransactions

**–§–∞–π–ª:** `src/I18n.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å `RECURRING_TRANSACTIONS: 'recurring_transactions'` –≤ `PF_SHEET_KEYS`
2. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –ª–∏—Å—Ç–∞, –∫–æ–ª–æ–Ω–æ–∫, –º–µ–Ω—é
3. –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è —á–∞—Å—Ç–æ—Ç:
   ```javascript
   recurring_frequency: {
     weekly: '–ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ' / 'Weekly',
     monthly: '–ï–∂–µ–º–µ—Å—è—á–Ω–æ' / 'Monthly',
     quarterly: '–ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ' / 'Quarterly',
     yearly: '–ï–∂–µ–≥–æ–¥–Ω–æ' / 'Yearly'
   }
   ```

---

### –ó–∞–¥–∞—á–∞ 2.4: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å RecurringTransactions.js

**–§–∞–π–ª:** `src/RecurringTransactions.js` (–Ω–æ–≤—ã–π)

**–§—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**

#### 2.4.1. `pfInitializeRecurringTransactions_(ss)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏—Å—Ç–∞ RecurringTransactions

**–ê–ª–≥–æ—Ä–∏—Ç–º:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ `pfInitializeBudgets_()`

**–í–∞–ª–∏–¥–∞—Ü–∏–∏:**
- `Type`: —Å–ø–∏—Å–æ–∫ –∏–∑ `PF_TRANSACTION_TYPE`
- `Frequency`: —Å–ø–∏—Å–æ–∫ –∏–∑ `PF_RECURRING_FREQUENCY`
- `Account`: –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞ Accounts
- `Currency`: —Å–ø–∏—Å–æ–∫ –≤–∞–ª—é—Ç
- `DayOfMonth`: —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 31
- `DayOfWeek`: —á–∏—Å–ª–æ –æ—Ç 1 –¥–æ 7

---

#### 2.4.2. `pfShouldCreateTransaction_(recurringTx, currentDate)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∫–∞, –Ω—É–∂–Ω–æ –ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –¥–ª—è —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `recurringTx` (Object) ‚Äî –æ–±—ä–µ–∫—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ (—Å—Ç—Ä–æ–∫–∞ –∏–∑ –ª–∏—Å—Ç–∞)
- `currentDate` (Date, optional) ‚Äî —Ç–µ–∫—É—â–∞—è –¥–∞—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `new Date()`)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `boolean` ‚Äî –Ω—É–∂–Ω–æ –ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `Active = true`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `currentDate >= StartDate`
3. –ï—Å–ª–∏ `EndDate` —É–∫–∞–∑–∞–Ω, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `currentDate <= EndDate`
4. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `Frequency`:
   - **weekly**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ—à–ª–∞ –Ω–µ–¥–µ–ª—è —Å `LastCreated` (–∏–ª–∏ `LastCreated` –ø—É—Å—Ç–æ)
   - **monthly**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ –Ω–∞—Å—Ç—É–ø–∏–ª –∏ `LastCreated < –Ω–∞—á–∞–ª–æ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞`
   - **quarterly**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ—à–ª–æ 3 –º–µ—Å—è—Ü–∞ —Å `LastCreated`
   - **yearly**: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø—Ä–æ—à–ª–æ 12 –º–µ—Å—è—Ü–µ–≤ —Å `LastCreated`
5. –î–ª—è monthly/quarterly/yearly: –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `DayOfMonth` —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ç–µ–∫—É—â–∏–º –¥–Ω–µ–º –º–µ—Å—è—Ü–∞ (–∏–ª–∏ –±–ª–∏–∂–∞–π—à–∏–π –ø—Ä–æ—à–µ–¥—à–∏–π)

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ `Frequency` –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Äî –≤–µ—Ä–Ω—É—Ç—å `false` –∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É
- –ï—Å–ª–∏ `StartDate` –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Äî –≤–µ—Ä–Ω—É—Ç—å `false`

**–û—Å–æ–±—ã–µ —Å–ª—É—á–∞–∏:**
- –ï—Å–ª–∏ `LastCreated` –ø—É—Å—Ç–æ ‚Äî —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–ª–∞—Å—å
- –î–ª—è monthly: –µ—Å–ª–∏ –¥–µ–Ω—å –º–µ—Å—è—Ü–∞ —É–∂–µ –ø—Ä–æ—à–µ–ª –≤ —Ç–µ–∫—É—â–µ–º –º–µ—Å—è—Ü–µ –∏ `LastCreated < –Ω–∞—á–∞–ª–æ –º–µ—Å—è—Ü–∞` ‚Üí —Å–æ–∑–¥–∞—Ç—å
- –î–ª—è weekly: –µ—Å–ª–∏ –ø—Ä–æ—à–ª–æ >= 7 –¥–Ω–µ–π —Å `LastCreated` ‚Üí —Å–æ–∑–¥–∞—Ç—å

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç –¥–ª—è weekly (–ø—Ä–æ—à–ª–∞ –Ω–µ–¥–µ–ª—è)
- –¢–µ—Å—Ç –¥–ª—è monthly (–¥–µ–Ω—å –º–µ—Å—è—Ü–∞ –Ω–∞—Å—Ç—É–ø–∏–ª)
- –¢–µ—Å—Ç –¥–ª—è quarterly (–ø—Ä–æ—à–ª–æ 3 –º–µ—Å—è—Ü–∞)
- –¢–µ—Å—Ç –¥–ª—è yearly (–ø—Ä–æ—à–ª–æ 12 –º–µ—Å—è—Ü–µ–≤)
- –¢–µ—Å—Ç —Å `LastCreated` –ø—É—Å—Ç—ã–º
- –¢–µ—Å—Ç —Å `EndDate` –≤ –ø—Ä–æ—à–ª–æ–º
- –¢–µ—Å—Ç —Å `Active = false`

---

#### 2.4.3. `pfGetNextDueDate_(recurringTx)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –¥–∞—Ç—É –ø–ª–∞—Ç–µ–∂–∞

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `recurringTx` (Object) ‚Äî –æ–±—ä–µ–∫—Ç —Ä–µ–≥—É–ª—è—Ä–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Date|null` ‚Äî —Å–ª–µ–¥—É—é—â–∞—è –¥–∞—Ç–∞ –ø–ª–∞—Ç–µ–∂–∞ –∏–ª–∏ null

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –±–∞–∑–æ–≤—É—é –¥–∞—Ç—É:
   - –ï—Å–ª–∏ `LastCreated` —É–∫–∞–∑–∞–Ω ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `LastCreated`
   - –ò–Ω–∞—á–µ ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `StartDate`
2. –í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `Frequency`:
   - **weekly**: –î–æ–±–∞–≤–∏—Ç—å 7 –¥–Ω–µ–π
   - **monthly**: –î–æ–±–∞–≤–∏—Ç—å 1 –º–µ—Å—è—Ü, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `DayOfMonth`
   - **quarterly**: –î–æ–±–∞–≤–∏—Ç—å 3 –º–µ—Å—è—Ü–∞, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `DayOfMonth`
   - **yearly**: –î–æ–±–∞–≤–∏—Ç—å 1 –≥–æ–¥, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `DayOfMonth`
3. –ï—Å–ª–∏ –ø–æ–ª—É—á–µ–Ω–Ω–∞—è –¥–∞—Ç–∞ > `EndDate` (–µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω) ‚Üí –≤–µ—Ä–Ω—É—Ç—å null

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ `DayOfMonth` –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π –¥–ª—è –º–µ—Å—è—Ü–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, 31 —Ñ–µ–≤—Ä–∞–ª—è) ‚Üí –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π –¥–µ–Ω—å –º–µ—Å—è—Ü–∞
- –ï—Å–ª–∏ `StartDate` –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Üí –≤–µ—Ä–Ω—É—Ç—å null

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç –¥–ª—è weekly
- –¢–µ—Å—Ç –¥–ª—è monthly —Å —Ä–∞–∑–Ω—ã–º–∏ –¥–Ω—è–º–∏ –º–µ—Å—è—Ü–∞
- –¢–µ—Å—Ç —Å `DayOfMonth = 31` –¥–ª—è –º–µ—Å—è—Ü–∞ —Å 30 –¥–Ω—è–º–∏
- –¢–µ—Å—Ç —Å `EndDate` –≤ –ø—Ä–æ—à–ª–æ–º

---

#### 2.4.4. `pfCreateRecurringTransactions_(ss, startDate, endDate)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è –≤—Å–µ—Ö —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π –∑–∞ –ø–µ—Ä–∏–æ–¥

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ss` (Spreadsheet, optional) ‚Äî —Ç–∞–±–ª–∏—Ü–∞
- `startDate` (Date, optional) ‚Äî –Ω–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞ –ø–µ—Ä–∏–æ–¥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞—á–∞–ª–æ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞)
- `endDate` (Date, optional) ‚Äî –∫–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞ –ø–µ—Ä–∏–æ–¥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∫–æ–Ω–µ—Ü —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Object` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: `{created: number, skipped: number, errors: number}`

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç RecurringTransactions
2. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å `getLastRow()` –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
3. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
   - –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å, –µ—Å–ª–∏ `Active = false` –∏–ª–∏ –ø—É—Å—Ç–æ
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ `pfShouldCreateTransaction_`, –Ω—É–∂–Ω–æ –ª–∏ —Å–æ–∑–¥–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é
   - –ï—Å–ª–∏ –Ω—É–∂–Ω–æ:
     - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–∞—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:
       - –î–ª—è monthly: —Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü, `DayOfMonth`
       - –î–ª—è weekly: –±–ª–∏–∂–∞–π—à–∏–π –ø—Ä–æ—à–µ–¥—à–∏–π –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏
       - –î–ª—è quarterly/yearly: –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ monthly
     - –°–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:
       ```javascript
       {
         date: transactionDate,
         type: recurringTx.Type,
         account: recurringTx.Account,
         accountTo: recurringTx.AccountTo,
         amount: recurringTx.Amount,
         currency: recurringTx.Currency,
         category: recurringTx.Category,
         subcategory: recurringTx.Subcategory,
         merchant: recurringTx.Merchant,
         description: recurringTx.Description || recurringTx.Name,
         source: PF_IMPORT_SOURCE.MANUAL,
         status: PF_TRANSACTION_STATUS.OK
       }
       ```
     - –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –ª–∏—Å—Ç Transactions
     - –û–±–Ω–æ–≤–∏—Ç—å `LastCreated` –≤ RecurringTransactions
     - –£–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ `created`
   - –ï—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ ‚Üí —É–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ `skipped`
4. –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ‚Äî –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å, —É–≤–µ–ª–∏—á–∏—Ç—å `errors`, –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ `LastCreated` ‚Äî –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π (—Å–æ–±—Ä–∞—Ç—å –≤—Å–µ, –∑–∞–ø–∏—Å–∞—Ç—å –æ–¥–Ω–∏–º `setValues()`)
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –ª–∏—Å—Ç–æ–≤

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç
- –¢–µ—Å—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –ø–ª–∞—Ç–µ–∂–∞–º–∏
- –¢–µ—Å—Ç —Å `Active = false` (–Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è)
- –¢–µ—Å—Ç —Å `LastCreated` (–Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç—ã)
- –¢–µ—Å—Ç —Å `EndDate` –≤ –ø—Ä–æ—à–ª–æ–º (–Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è)

---

#### 2.4.5. `pfCreateRecurringTransactions()` (–ø—É–±–ª–∏—á–Ω–∞—è)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—É–±–ª–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–∑–æ–≤–∞ –∏–∑ –º–µ–Ω—é

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –ø–µ—Ä–∏–æ–¥–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
2. –í—ã–∑–≤–∞—Ç—å `pfCreateRecurringTransactions_()` —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º –ø–µ—Ä–∏–æ–¥–æ–º
3. –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é

**UI:**
- –î–∏–∞–ª–æ–≥ —Å –æ–ø—Ü–∏—è–º–∏: "–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü", "–£–∫–∞–∑–∞—Ç—å –ø–µ—Ä–∏–æ–¥", "–û—Ç–º–µ–Ω–∞"
- –ï—Å–ª–∏ –≤—ã–±—Ä–∞–Ω "–£–∫–∞–∑–∞—Ç—å –ø–µ—Ä–∏–æ–¥" ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –¥–≤–∞ –ø–æ–ª—è –¥–ª—è –¥–∞—Ç

---

### –ó–∞–¥–∞—á–∞ 2.5: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Setup.js

**–§–∞–π–ª:** `src/Setup.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –≤—ã–∑–æ–≤ `pfInitializeRecurringTransactions_(ss)` –≤ `pfRunSetup_()`
- –î–æ–±–∞–≤–∏—Ç—å –≤ `pfApplyLocalization_()`

---

### –ó–∞–¥–∞—á–∞ 2.6: –î–æ–±–∞–≤–∏—Ç—å –≤–∏–¥–∂–µ—Ç –≤ Dashboard.js

**–§–∞–π–ª:** `src/Dashboard.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "–ü—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏"
2. –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ —Ä–µ–≥—É–ª—è—Ä–Ω—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω—ã –≤ –±–ª–∏–∂–∞–π—à–∏–µ 7 –¥–Ω–µ–π
3. –ü–æ–∫–∞–∑–∞—Ç—å —Å—É–º–º—É –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –ø–ª–∞—Ç–µ–∂–µ–π

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –≤—ã—á–∏—Å–ª–∏—Ç—å `pfGetNextDueDate_()`
3. –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç–µ, —É –∫–æ—Ç–æ—Ä—ã—Ö –¥–∞—Ç–∞ –≤ –±–ª–∏–∂–∞–π—à–∏–µ 7 –¥–Ω–µ–π
4. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ –¥–∞—Ç–µ
5. –ó–∞–ø–∏—Å–∞—Ç—å –≤ Dashboard –ª–∏—Å—Ç

---

### –ó–∞–¥–∞—á–∞ 2.7: –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é

**–§–∞–π–ª:** `src/Code.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç "–°–æ–∑–¥–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏" –≤ –º–µ–Ω—é

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 2

- ‚úÖ –õ–∏—Å—Ç RecurringTransactions —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ Setup
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–π –ø–ª–∞—Ç–µ–∂ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π —á–∞—Å—Ç–æ—Ç—ã
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç (Frequency, DayOfMonth, DayOfWeek)
- ‚úÖ –ú–µ–Ω—é "–°–æ–∑–¥–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏" —Å–æ–∑–¥–∞–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –¥–∞—Ç–æ–π, —Å—É–º–º–æ–π, –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π
- ‚úÖ –ù–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –¥—É–±–ª–∏–∫–∞—Ç—ã (–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ LastCreated)
- ‚úÖ –í Dashboard –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏–µ –ø–ª–∞—Ç–µ–∂–∏
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## –≠—Ç–∞–ø 3: –ê–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è üü°

**ID:** TASK-003  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–û—Ü–µ–Ω–∫–∞:** 4-5 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 3.1: –†–∞—Å—à–∏—Ä–∏—Ç—å Schema.js –¥–ª—è CategoryRules

**–§–∞–π–ª:** `src/Schema.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å `PF_CATEGORY_RULES_SCHEMA`
2. –°—Ç—Ä—É–∫—Ç—É—Ä–∞:
   ```javascript
   var PF_CATEGORY_RULES_SCHEMA = {
     sheetKey: 'category_rules',
     columns: [
       { key: 'RuleName', required: true },
       { key: 'Pattern', required: true },
       { key: 'PatternType', required: true, allowed: ['contains', 'startsWith', 'endsWith', 'regex', 'exact'] },
       { key: 'Category', required: true },
       { key: 'Subcategory', required: false },
       { key: 'Priority', required: false },
       { key: 'Active', required: false },
       { key: 'ApplyTo', required: false, allowed: ['merchant', 'description', 'both'] }
     ]
   };
   ```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `PatternType = regex` ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ Pattern –≤–∞–ª–∏–¥–Ω—ã–π regex (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω–æ)
- `Priority` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å–ª–æ–º (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)
- `ApplyTo` –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `both`

---

### –ó–∞–¥–∞—á–∞ 3.2: –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

**–§–∞–π–ª:** `src/Constants.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã —Ç–∏–ø–æ–≤ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤:
   ```javascript
   var PF_PATTERN_TYPE = {
     CONTAINS: 'contains',
     STARTS_WITH: 'startsWith',
     ENDS_WITH: 'endsWith',
     REGEX: 'regex',
     EXACT: 'exact'
   };
   ```

2. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:
   ```javascript
   var PF_RULE_APPLY_TO = {
     MERCHANT: 'merchant',
     DESCRIPTION: 'description',
     BOTH: 'both'
   };
   ```

---

### –ó–∞–¥–∞—á–∞ 3.3: –î–æ–±–∞–≤–∏—Ç—å i18n –∫–ª—é—á–∏

**–§–∞–π–ª:** `src/I18n.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è –ª–∏—Å—Ç–∞, –∫–æ–ª–æ–Ω–æ–∫, —Ç–∏–ø–æ–≤ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

---

### –ó–∞–¥–∞—á–∞ 3.4: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å CategoryRules.js

**–§–∞–π–ª:** `src/CategoryRules.js` (–Ω–æ–≤—ã–π)

**–§—É–Ω–∫—Ü–∏–∏:**

#### 3.4.1. `pfInitializeCategoryRules_(ss)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏—Å—Ç–∞ CategoryRules

**–ê–ª–≥–æ—Ä–∏—Ç–º:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥—Ä—É–≥–∏–º –ª–∏—Å—Ç–∞–º

---

#### 3.4.2. `pfMatchCategoryRule_(merchant, description, rules)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∏—Å–∫ –ø–æ–¥—Ö–æ–¥—è—â–µ–≥–æ –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `merchant` (string) ‚Äî –º–µ—Ä—á–∞–Ω—Ç
- `description` (string) ‚Äî –æ–ø–∏—Å–∞–Ω–∏–µ
- `rules` (Array<Object>) ‚Äî –º–∞—Å—Å–∏–≤ –ø—Ä–∞–≤–∏–ª (—Å—Ç—Ä–æ–∫–∏ –∏–∑ –ª–∏—Å—Ç–∞)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Object|null` ‚Äî –ø–µ—Ä–≤–æ–µ –ø–æ–¥—Ö–æ–¥—è—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ –∏–ª–∏ null

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –û—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª–∞ –ø–æ `Priority` (–ø–æ —É–±—ã–≤–∞–Ω–∏—é)
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞:
   - –ï—Å–ª–∏ `Active = false` ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å
   - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫ –∫–∞–∫–æ–º—É –ø–æ–ª—é –ø—Ä–∏–º–µ–Ω—è—Ç—å (`ApplyTo`):
     - `merchant` ‚Üí –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ `merchant`
     - `description` ‚Üí –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ç–æ–ª—å–∫–æ `description`
     - `both` ‚Üí –ø—Ä–æ–≤–µ—Ä—è—Ç—å –æ–±–∞
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `PatternType`:
     - `contains`: `field.indexOf(Pattern) !== -1`
     - `startsWith`: `field.startsWith(Pattern)`
     - `endsWith`: `field.endsWith(Pattern)`
     - `exact`: `field === Pattern`
     - `regex`: `new RegExp(Pattern, 'i').test(field)`
   - –ï—Å–ª–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –≤–µ—Ä–Ω—É—Ç—å –ø—Ä–∞–≤–∏–ª–æ
3. –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –≤–µ—Ä–Ω—É—Ç—å null

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ `PatternType = regex` –∏ Pattern –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∞–≤–∏–ª–æ –∏ –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
- –ï—Å–ª–∏ `merchant` –∏–ª–∏ `description` null/undefined ‚Üí –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –∫–∞–∫ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ regex –¥–ª—è –ø—Ä–∞–≤–∏–ª —Å `PatternType = regex`
- –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å `merchant` –∏ `description` –≤ lowercase –¥–ª—è case-insensitive –ø–æ–∏—Å–∫–∞ (–∫—Ä–æ–º–µ regex)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å `contains` –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º
- –¢–µ—Å—Ç —Å `startsWith` –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º
- –¢–µ—Å—Ç —Å `regex` –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º
- –¢–µ—Å—Ç —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º–∏ (–≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª–æ —Å –±–æ–ª—å—à–∏–º –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º)
- –¢–µ—Å—Ç —Å `ApplyTo = merchant` (–Ω–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç description)
- –¢–µ—Å—Ç –±–µ–∑ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π

---

#### 3.4.3. `pfApplyCategoryRules_(transaction)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∞–≤–∏–ª –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `transaction` (TransactionDTO –∏–ª–∏ Object) ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `TransactionDTO` ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–º–∏ Category/Subcategory

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ï—Å–ª–∏ —É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —É–∂–µ –µ—Å—Ç—å Category ‚Üí –Ω–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å –ø—Ä–∞–≤–∏–ª–∞ (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å)
2. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞ –∏–∑ –ª–∏—Å—Ç–∞ CategoryRules
3. –í—ã–∑–≤–∞—Ç—å `pfMatchCategoryRule_(transaction.merchant, transaction.description, rules)`
4. –ï—Å–ª–∏ –ø—Ä–∞–≤–∏–ª–æ –Ω–∞–π–¥–µ–Ω–æ:
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `transaction.category = rule.Category`
   - –ï—Å–ª–∏ `rule.Subcategory` —É–∫–∞–∑–∞–Ω–∞ ‚Üí —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `transaction.subcategory = rule.Subcategory`
5. –í–µ—Ä–Ω—É—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–∏ –ø—Ä–∞–≤–∏–ª–∞ ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∞–≤–∏–ª–∞
- –¢–µ—Å—Ç, –∫–æ–≥–¥–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è)
- –¢–µ—Å—Ç –±–µ–∑ –ø–æ–¥—Ö–æ–¥—è—â–∏—Ö –ø—Ä–∞–≤–∏–ª
- –¢–µ—Å—Ç —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –ø–æ–¥—Ö–æ–¥—è—â–∏–º–∏ –ø—Ä–∞–≤–∏–ª–∞–º–∏ (–≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É)

---

#### 3.4.4. `pfAutoCategorizeTransaction_(transaction)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—É–±–ª–∏—á–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ –æ–¥–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `transaction` (Object) ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Object` ‚Äî —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
- –í—ã–∑–≤–∞—Ç—å `pfApplyCategoryRules_()`

---

#### 3.4.5. `pfApplyAutoCategorizationToAll_(ss)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏ –∫–æ –≤—Å–µ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è–º –±–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ss` (Spreadsheet, optional) ‚Äî —Ç–∞–±–ª–∏—Ü–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Transactions
2. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å `getLastRow()` –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
3. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
   - –ï—Å–ª–∏ Category —É–∂–µ —É–∫–∞–∑–∞–Ω–∞ ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å
   - –°–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏–∑ —Å—Ç—Ä–æ–∫–∏
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å `pfApplyCategoryRules_()`
   - –ï—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ ‚Üí –æ–±–Ω–æ–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É –≤ –ª–∏—Å—Ç–µ
4. –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É: —Å–∫–æ–ª—å–∫–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ–ª—É—á–∏–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏/–∑–∞–ø–∏—Å–∏ ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

---

### –ó–∞–¥–∞—á–∞ 3.5: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Import.js

**–§–∞–π–ª:** `src/Import.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –í —Ñ—É–Ω–∫—Ü–∏–∏ `pfProcessDataBatch()` –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–æ–±–∞–≤–∏—Ç—å:
   ```javascript
   // Apply auto-categorization if category is not set
   if (!transaction.category || transaction.category === '') {
     transaction = pfApplyCategoryRules_(transaction);
   }
   ```

**–î–µ—Ç–∞–ª–∏:**
- –ü—Ä–∏–º–µ–Ω—è—Ç—å —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
- –ù–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ò–º–ø–æ—Ä—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å Merchant="–ü—è—Ç—ë—Ä–æ—á–∫–∞"
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ò–º–ø–æ—Ä—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π (–Ω–µ –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è)

---

### –ó–∞–¥–∞—á–∞ 3.6: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ Validation.js

**–§–∞–π–ª:** `src/Validation.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –í —Ñ—É–Ω–∫—Ü–∏–∏ `pfNormalizeTransactionRow_()` –ø–æ—Å–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è Merchant/Description –¥–æ–±–∞–≤–∏—Ç—å:
   ```javascript
   // Auto-categorize if category is not set
   if (!category || category === '') {
     var merchant = row[merchantColIdx - 1] || '';
     var description = row[descriptionColIdx - 1] || '';
     var rule = pfMatchCategoryRule_(merchant, description, pfGetAllCategoryRules_());
     if (rule) {
       // Update category in row (need to write back to sheet)
       // This is tricky - may need to read rules and apply
     }
   }
   ```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω–æ, —Ç–∞–∫ –∫–∞–∫ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —è—á–µ–π–∫—É –≤ –ª–∏—Å—Ç–µ. –í–æ–∑–º–æ–∂–Ω–æ, –ª—É—á—à–µ –≤—ã–∑—ã–≤–∞—Ç—å —á–µ—Ä–µ–∑ –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Å–ª–µ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏.

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
- –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `pfAutoCategorizeRow_(sheet, rowNum)` –∫–æ—Ç–æ—Ä–∞—è:
  1. –ß–∏—Ç–∞–µ—Ç —Å—Ç—Ä–æ–∫—É
  2. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –ø—Ä–∞–≤–∏–ª–∞
  3. –û–±–Ω–æ–≤–ª—è–µ—Ç Category/Subcategory –≤ –ª–∏—Å—Ç–µ

---

### –ó–∞–¥–∞—á–∞ 3.7: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–µ–¥–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –ø—Ä–∞–≤–∏–ª–∞

**–§–∞–π–ª:** `src/CategoryRules.js` –∏–ª–∏ `src/DemoData.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `pfCreateDefaultCategoryRules_(ss)` —Å –ø—Ä–∏–º–µ—Ä–∞–º–∏ –ø—Ä–∞–≤–∏–ª:
   ```javascript
   var defaultRules = [
     ['–ü—è—Ç—ë—Ä–æ—á–∫–∞', 'contains', '–ü—Ä–æ–¥—É–∫—Ç—ã', '', 10, true, 'both'],
     ['–ú–∞–≥–Ω–∏—Ç', 'contains', '–ü—Ä–æ–¥—É–∫—Ç—ã', '', 10, true, 'both'],
     ['–ü–µ—Ä–µ–∫—Ä–µ—Å—Ç–æ–∫', 'contains', '–ü—Ä–æ–¥—É–∫—Ç—ã', '', 10, true, 'both'],
     ['–∫–∞—Ñ–µ', 'contains', '–†–µ—Å—Ç–æ—Ä–∞–Ω—ã', '', 5, true, 'both'],
     ['—Ä–µ—Å—Ç–æ—Ä–∞–Ω', 'contains', '–†–µ—Å—Ç–æ—Ä–∞–Ω—ã', '', 5, true, 'both'],
     // –∏ —Ç.–¥.
   ];
   ```

2. –í—ã–∑—ã–≤–∞—Ç—å —ç—Ç—É —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏ –ø–µ—Ä–≤–æ–º Setup (–µ—Å–ª–∏ –ª–∏—Å—Ç CategoryRules –ø—É—Å—Ç–æ–π)

---

### –ó–∞–¥–∞—á–∞ 3.8: –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é

**–§–∞–π–ª:** `src/Code.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç "–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—é" ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `pfApplyAutoCategorizationToAll_()`

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 3

- ‚úÖ –õ–∏—Å—Ç CategoryRules —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ Setup
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–∞–≤–∏–ª–æ (–ø–∞—Ç—Ç–µ—Ä–Ω ‚Üí –∫–∞—Ç–µ–≥–æ—Ä–∏—è)
- ‚úÖ –ü—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–ª—É—á–∞—é—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏—é
- ‚úÖ –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É
- ‚úÖ –ú–µ–Ω—é "–ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—é" —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤—Å–µ —Ç–∏–ø—ã –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ (contains, startsWith, endsWith, regex, exact)
- ‚úÖ –ü—Ä–∞–≤–∏–ª–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ merchant, description –∏–ª–∏ both

---

## –≠—Ç–∞–ø 4: –ú—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç—å üü°

**ID:** TASK-004  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π (–µ—Å–ª–∏ –Ω—É–∂–Ω–∞)  
**–û—Ü–µ–Ω–∫–∞:** 6-8 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 4.1: –†–∞—Å—à–∏—Ä–∏—Ç—å Schema.js –¥–ª—è ExchangeRates

**–§–∞–π–ª:** `src/Schema.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å `PF_EXCHANGE_RATES_SCHEMA`:
   ```javascript
   var PF_EXCHANGE_RATES_SCHEMA = {
     sheetKey: 'exchange_rates',
     columns: [
       { key: 'Date', required: true },
       { key: 'Currency', required: true },
       { key: 'Rate', required: true },
       { key: 'Source', required: false }
     ]
   };
   ```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- `Rate` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º —á–∏—Å–ª–æ–º
- `Currency` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –∏–∑ —Å–ø–∏—Å–∫–∞ –≤–∞–ª—é—Ç (–∫—Ä–æ–º–µ –±–∞–∑–æ–≤–æ–π)
- `Date` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤–∞–ª–∏–¥–Ω–æ–π –¥–∞—Ç–æ–π

---

### –ó–∞–¥–∞—á–∞ 4.2: –†–∞—Å—à–∏—Ä–∏—Ç—å Settings.js

**–§–∞–π–ª:** `src/Settings.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É `BaseCurrency` –≤ `PF_SETTINGS_KEYS`
2. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `PF_DEFAULT_CURRENCY` (RUB)
3. –§—É–Ω–∫—Ü–∏—è `pfGetBaseCurrency_(ss)` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –±–∞–∑–æ–≤—É—é –≤–∞–ª—é—Ç—É
4. –§—É–Ω–∫—Ü–∏—è `pfSetBaseCurrency_(ss, currency)` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –±–∞–∑–æ–≤—É—é –≤–∞–ª—é—Ç—É

---

### –ó–∞–¥–∞—á–∞ 4.3: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å ExchangeRates.js

**–§–∞–π–ª:** `src/ExchangeRates.js` (–Ω–æ–≤—ã–π)

**–§—É–Ω–∫—Ü–∏–∏:**

#### 4.3.1. `pfInitializeExchangeRates_(ss)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ª–∏—Å—Ç–∞ ExchangeRates

**–ê–ª–≥–æ—Ä–∏—Ç–º:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥—Ä—É–≥–∏–º –ª–∏—Å—Ç–∞–º

---

#### 4.3.2. `pfGetExchangeRate_(currency, date)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å –∫—É—Ä—Å –≤–∞–ª—é—Ç—ã –Ω–∞ –¥–∞—Ç—É

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `currency` (string) ‚Äî –≤–∞–ª—é—Ç–∞
- `date` (Date) ‚Äî –¥–∞—Ç–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `number|null` ‚Äî –∫—É—Ä—Å –∏–ª–∏ null, –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ï—Å–ª–∏ `currency === BaseCurrency` ‚Üí –≤–µ—Ä–Ω—É—Ç—å 1.0
2. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç ExchangeRates
3. –ù–∞–π—Ç–∏ –∫—É—Ä—Å –¥–ª—è –≤–∞–ª—é—Ç—ã –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—É—é –¥–∞—Ç—É:
   - –ò—Å–∫–∞—Ç—å —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –ø–æ –¥–∞—Ç–µ
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –Ω–∞–π—Ç–∏ –±–ª–∏–∂–∞–π—à—É—é –ø—Ä–µ–¥—ã–¥—É—â—É—é –¥–∞—Ç—É
4. –ï—Å–ª–∏ –∫—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –≤–µ—Ä–Ω—É—Ç—å null

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –≤–∞–ª—é—Ç–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–∞—è ‚Üí –≤–µ—Ä–Ω—É—Ç—å null
- –ï—Å–ª–∏ –¥–∞—Ç–∞ –Ω–µ–≤–∞–ª–∏–¥–Ω–∞—è ‚Üí –≤–µ—Ä–Ω—É—Ç—å null
- –ï—Å–ª–∏ –∫—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –∫—É—Ä—Å—ã –≤ –ø–∞–º—è—Ç–∏ –¥–ª—è —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞—Ç
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∏–Ω–∞—Ä–Ω—ã–π –ø–æ–∏—Å–∫ –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ –¥–∞—Ç–µ (–µ—Å–ª–∏ –∫—É—Ä—Å–æ–≤ –º–Ω–æ–≥–æ)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫—É—Ä—Å–æ–º
- –¢–µ—Å—Ç —Å –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º –∫—É—Ä—Å–æ–º
- –¢–µ—Å—Ç —Å –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–æ–π (–¥–æ–ª–∂–µ–Ω –≤–µ—Ä–Ω—É—Ç—å 1.0)
- –¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞ –±–ª–∏–∂–∞–π—à–µ–π –ø—Ä–µ–¥—ã–¥—É—â–µ–π –¥–∞—Ç—ã

---

#### 4.3.3. `pfConvertToBaseCurrency_(amount, currency, date)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å—á–µ—Ç —Å—É–º–º—ã –≤ –±–∞–∑–æ–≤—É—é –≤–∞–ª—é—Ç—É

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `amount` (number) ‚Äî —Å—É–º–º–∞
- `currency` (string) ‚Äî –≤–∞–ª—é—Ç–∞ —Å—É–º–º—ã
- `date` (Date) ‚Äî –¥–∞—Ç–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `number|null` ‚Äî —Å—É–º–º–∞ –≤ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–µ –∏–ª–∏ null

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ï—Å–ª–∏ `currency === BaseCurrency` ‚Üí –≤–µ—Ä–Ω—É—Ç—å `amount`
2. –ü–æ–ª—É—á–∏—Ç—å –∫—É—Ä—Å —á–µ—Ä–µ–∑ `pfGetExchangeRate_(currency, date)`
3. –ï—Å–ª–∏ –∫—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –≤–µ—Ä–Ω—É—Ç—å null
4. –í–µ—Ä–Ω—É—Ç—å `amount * rate`

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –∫—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –∏ –≤–µ—Ä–Ω—É—Ç—å null
- –ï—Å–ª–∏ amount –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Üí –≤–µ—Ä–Ω—É—Ç—å null

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–æ–π
- –¢–µ—Å—Ç —Å –¥—Ä—É–≥–æ–π –≤–∞–ª—é—Ç–æ–π
- –¢–µ—Å—Ç —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º –∫—É—Ä—Å–æ–º

---

#### 4.3.4. `pfUpdateExchangeRatesFromCBR_(ss)` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –∏–∑ API –¶–ë –†–§

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ss` (Spreadsheet) ‚Äî —Ç–∞–±–ª–∏—Ü–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É
2. –í—ã–∑–≤–∞—Ç—å API –¶–ë –†–§: `https://www.cbr-xml-daily.ru/daily_json.js`
3. –ü–∞—Ä—Å–∏—Ç—å JSON –æ—Ç–≤–µ—Ç
4. –î–ª—è –∫–∞–∂–¥–æ–π –≤–∞–ª—é—Ç—ã (USD, EUR):
   - –ü–æ–ª—É—á–∏—Ç—å –∫—É—Ä—Å –∫ RUB
   - –î–æ–±–∞–≤–∏—Ç—å –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å –≤ –ª–∏—Å—Ç–µ ExchangeRates
5. –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É
- –ï—Å–ª–∏ JSON –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–π ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É
- –ï—Å–ª–∏ –≤–∞–ª—é—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –æ—Ç–≤–µ—Ç–µ ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≠—Ç–æ –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –ú–æ–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–∑–∂–µ –∏–ª–∏ –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞ –∫—É—Ä—Å–æ–≤.

---

### –ó–∞–¥–∞—á–∞ 4.4: –û–±–Ω–æ–≤–∏—Ç—å Reports.js –¥–ª—è –º—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç–∏

**–§–∞–π–ª:** `src/Reports.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫—É "–í –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–µ" –≤ —Å–µ–∫—Ü–∏–∏ –æ—Ç—á–µ—Ç–æ–≤
2. –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å —Å—É–º–º—ã –≤ –±–∞–∑–æ–≤—É—é –≤–∞–ª—é—Ç—É –ø–æ –∫—É—Ä—Å—É –Ω–∞ –¥–∞—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü—Ä–∏ —Ä–∞—Å—á–µ—Ç–µ –¥–æ—Ö–æ–¥–æ–≤/—Ä–∞—Å—Ö–æ–¥–æ–≤:
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ –≤–∞–ª—é—Ç–µ
   - –î–ª—è –∫–∞–∂–¥–æ–π –≤–∞–ª—é—Ç—ã:
     - –°—É–º–º–∏—Ä–æ–≤–∞—Ç—å –≤ –∏—Å—Ö–æ–¥–Ω–æ–π –≤–∞–ª—é—Ç–µ
     - –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –≤ –±–∞–∑–æ–≤—É—é –≤–∞–ª—é—Ç—É —á–µ—Ä–µ–∑ `pfConvertToBaseCurrency_()`
   - –°—É–º–º–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≤ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–µ
2. –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–≤–µ –∫–æ–ª–æ–Ω–∫–∏:
   - "–°—É–º–º–∞" ‚Äî –≤ –∏—Å—Ö–æ–¥–Ω–æ–π –≤–∞–ª—é—Ç–µ (–µ—Å–ª–∏ –≤—Å–µ –≤ –æ–¥–Ω–æ–π –≤–∞–ª—é—Ç–µ) –∏–ª–∏ "–°–º–µ—à–∞–Ω–Ω—ã–µ –≤–∞–ª—é—Ç—ã"
   - "–í –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–µ" ‚Äî –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–Ω–∞—è —Å—É–º–º–∞

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –∫—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω –¥–ª—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –∏—Å–∫–ª—é—á–∏—Ç—å –∏–∑ —Ä–∞—Å—á–µ—Ç–∞ –∏–ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω–æ

---

### –ó–∞–¥–∞—á–∞ 4.5: –û–±–Ω–æ–≤–∏—Ç—å Dashboard.js –¥–ª—è –º—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç–∏

**–§–∞–π–ª:** `src/Dashboard.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- KPI –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–µ
- –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—Ç—å –≤—Å–µ —Å—É–º–º—ã —á–µ—Ä–µ–∑ `pfConvertToBaseCurrency_()`

---

### –ó–∞–¥–∞—á–∞ 4.6: –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é

**–§–∞–π–ª:** `src/Code.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç "–û–±–Ω–æ–≤–∏—Ç—å –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç" ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `pfUpdateExchangeRatesFromCBR_()` –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 4

- ‚úÖ –õ–∏—Å—Ç ExchangeRates —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ Setup
- ‚úÖ –ú–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç –≤—Ä—É—á–Ω—É—é
- ‚úÖ –í Reports —Å—É–º–º—ã –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è –≤ –±–∞–∑–æ–≤—É—é –≤–∞–ª—é—Ç—É
- ‚úÖ –í Dashboard KPI –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤ –±–∞–∑–æ–≤–æ–π –≤–∞–ª—é—Ç–µ
- ‚úÖ –ö—É—Ä—Å—ã –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–∞ –¥–∞—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∫—É—Ä—Å—ã)
- ‚úÖ –ï—Å–ª–∏ –∫—É—Ä—Å –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Äî –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## –≠—Ç–∞–ø 5: –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

**ID:** TASK-005  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π  
**–û—Ü–µ–Ω–∫–∞:** 4-5 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 5.1: –î–æ–±–∞–≤–∏—Ç—å —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –ø–µ—Ä–∏–æ–¥–æ–º –≤ Reports.js

**–§–∞–π–ª:** `src/Reports.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –í —Å–µ–∫—Ü–∏–∏ "–°–≤–æ–¥–∫–∞ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º" –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–ª–æ–Ω–∫–∏:
   - "–ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü" ‚Äî –¥–æ—Ö–æ–¥—ã/—Ä–∞—Å—Ö–æ–¥—ã –∑–∞ –ø—Ä–æ—à–ª—ã–π –º–µ—Å—è—Ü
   - "–ò–∑–º–µ–Ω–µ–Ω–∏–µ" ‚Äî —Ä–∞–∑–Ω–∏—Ü–∞ (—Ç–µ–∫—É—â–∏–π - –ø—Ä–µ–¥—ã–¥—É—â–∏–π)
   - "–ò–∑–º–µ–Ω–µ–Ω–∏–µ %" ‚Äî –ø—Ä–æ—Ü–µ–Ω—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –í—ã—á–∏—Å–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ (—É–∂–µ –µ—Å—Ç—å)
2. –í—ã—á–∏—Å–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞:
   - `previousMonthStart = new Date(today.getFullYear(), today.getMonth() - 1, 1)`
   - `previousMonthEnd = new Date(today.getFullYear(), today.getMonth(), 0)`
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ –∂–µ —Ñ–æ—Ä–º—É–ª—ã SUMIFS, –Ω–æ —Å –¥—Ä—É–≥–∏–º–∏ –¥–∞—Ç–∞–º–∏
3. –í—ã—á–∏—Å–ª–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏–µ:
   - `change = current - previous`
   - `changePercent = (change / previous) * 100` (–µ—Å–ª–∏ previous > 0)
4. –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
   - –ó–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç, –µ—Å–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ (–¥–ª—è –¥–æ—Ö–æ–¥–æ–≤) –∏–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ (–¥–ª—è —Ä–∞—Å—Ö–æ–¥–æ–≤)
   - –ö—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç ‚Äî –Ω–∞–æ–±–æ—Ä–æ—Ç

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞ –¥–≤–∞ –º–µ—Å—è—Ü–∞
- –¢–µ—Å—Ç —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü
- –¢–µ—Å—Ç —Å previous = 0 (–∏–∑–±–µ–∂–∞—Ç—å –¥–µ–ª–µ–Ω–∏—è –Ω–∞ –Ω–æ–ª—å)

---

### –ó–∞–¥–∞—á–∞ 5.2: –î–æ–±–∞–≤–∏—Ç—å —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ Reports.js

**–§–∞–π–ª:** `src/Reports.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "–°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è"
2. –ü–æ–∫–∞–∑–∞—Ç—å:
   - –°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –≤ –¥–µ–Ω—å (—Ç–µ–∫—É—â–∏–π –º–µ—Å—è—Ü)
   - –°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –≤ –º–µ—Å—è—Ü (–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3/6/12 –º–µ—Å—è—Ü–µ–≤)
   - –°—Ä–µ–¥–Ω–∏–π –¥–æ—Ö–æ–¥ –≤ –º–µ—Å—è—Ü (–∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3/6/12 –º–µ—Å—è—Ü–µ–≤)

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –≤ –¥–µ–Ω—å:
   - `totalExpenses / daysInMonth`
2. –°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥ –≤ –º–µ—Å—è—Ü:
   - –ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å—Ö–æ–¥—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ N –º–µ—Å—è—Ü–µ–≤
   - `average = total / N`
3. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –¥–æ—Ö–æ–¥–æ–≤

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∑–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–µ—Å—è—Ü–µ–≤
- –¢–µ—Å—Ç —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –¥–∞–Ω–Ω—ã—Ö

---

### –ó–∞–¥–∞—á–∞ 5.3: –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–≥–Ω–æ–∑ –≤ Reports.js

**–§–∞–π–ª:** `src/Reports.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å —Å–µ–∫—Ü–∏—é "–ü—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü"
2. –ê–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–æ–≥–Ω–æ–∑–∞:
   - –í–∞—Ä–∏–∞–Ω—Ç 1: –°—Ä–µ–¥–Ω–µ–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞
   - –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è –ø–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º 6 –º–µ—Å—è—Ü–∞–º (–±–æ–ª–µ–µ —Å–ª–æ–∂–Ω–æ)

**–ê–ª–≥–æ—Ä–∏—Ç–º (–≤–∞—Ä–∏–∞–Ω—Ç 1 ‚Äî —Å—Ä–µ–¥–Ω–µ–µ):**
1. –ü–æ–ª—É—á–∏—Ç—å —Ä–∞—Å—Ö–æ–¥—ã/–¥–æ—Ö–æ–¥—ã –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 3 –º–µ—Å—è—Ü–∞
2. `forecast = average(month1, month2, month3)`

**–ê–ª–≥–æ—Ä–∏—Ç–º (–≤–∞—Ä–∏–∞–Ω—Ç 2 ‚Äî —Ç—Ä–µ–Ω–¥):**
1. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 –º–µ—Å—è—Ü–µ–≤
2. –í—ã—á–∏—Å–ª–∏—Ç—å –ª–∏–Ω–µ–π–Ω—É—é —Ä–µ–≥—Ä–µ—Å—Å–∏—é: `y = a*x + b`
3. –≠–∫—Å—Ç—Ä–∞–ø–æ–ª–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ù–∞—á–∞—Ç—å —Å –≤–∞—Ä–∏–∞–Ω—Ç–∞ 1 (–ø—Ä–æ—â–µ), –≤–∞—Ä–∏–∞–Ω—Ç 2 –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–∑–∂–µ.

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç —Å –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –¥–∞–Ω–Ω—ã—Ö (–º–µ–Ω—å—à–µ 3 –º–µ—Å—è—Ü–µ–≤)

---

### –ó–∞–¥–∞—á–∞ 5.4: –î–æ–±–∞–≤–∏—Ç—å line chart –≤ Dashboard.js

**–§–∞–π–ª:** `src/Dashboard.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å line chart: –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã –ø–æ –º–µ—Å—è—Ü–∞–º (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 12 –º–µ—Å—è—Ü–µ–≤)
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Google Sheets Charts API

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ Reports (–º–µ—Å—è—á–Ω—ã–π cashflow) –∏–ª–∏ –≤—ã—á–∏—Å–ª–∏—Ç—å –∑–∞–Ω–æ–≤–æ
2. –°–æ–∑–¥–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–∞:
   - –ö–æ–ª–æ–Ω–∫–∞ 1: –ú–µ—Å—è—Ü (–º–µ—Ç–∫–∞)
   - –ö–æ–ª–æ–Ω–∫–∞ 2: –î–æ—Ö–æ–¥—ã
   - –ö–æ–ª–æ–Ω–∫–∞ 3: –†–∞—Å—Ö–æ–¥—ã
3. –°–æ–∑–¥–∞—Ç—å chart —á–µ—Ä–µ–∑ `dashboardSheet.newChart()`:
   ```javascript
   var chart = dashboardSheet.newChart()
     .setChartType(Charts.ChartType.LINE)
     .addRange(dataRange)
     .setPosition(row, 1, 0, 0)
     .setOption('title', '–î–∏–Ω–∞–º–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤')
     .setOption('legend', {position: 'bottom'})
     .build();
   dashboardSheet.insertChart(chart);
   ```

**–î–µ—Ç–∞–ª–∏:**
- –†–∞–∑–º–µ—Ä –≥—Ä–∞—Ñ–∏–∫–∞: –ø—Ä–∏–º–µ—Ä–Ω–æ 600x400 –ø–∏–∫—Å–µ–ª–µ–π
- –†–∞—Å–ø–æ–ª–æ–∂–∏—Ç—å –ø–æ—Å–ª–µ pie chart

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –¥–∞–Ω–Ω—ã—Ö

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 5

- ‚úÖ –í Reports –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –º–µ—Å—è—Ü–µ–º
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è (–≤ –¥–µ–Ω—å, –≤ –º–µ—Å—è—Ü)
- ‚úÖ –ï—Å—Ç—å –ø—Ä–æ—Å—Ç–æ–π –ø—Ä–æ–≥–Ω–æ–∑ –Ω–∞ —Å–ª–µ–¥—É—é—â–∏–π –º–µ—Å—è—Ü
- ‚úÖ –í Dashboard –µ—Å—Ç—å line chart –¥–∏–Ω–∞–º–∏–∫–∏
- ‚úÖ –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ (—Ü–≤–µ—Ç–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π)

---

## –≠—Ç–∞–ø 6: –ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

**ID:** TASK-006  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π  
**–û—Ü–µ–Ω–∫–∞:** 5-6 —á–∞—Å–æ–≤  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –≠—Ç–∞–ø 3 (–∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

### –ó–∞–¥–∞—á–∞ 6.1: –°–æ–∑–¥–∞—Ç—å HTML —Å–∞–π–¥–±–∞—Ä QuickEntry.html

**–§–∞–π–ª:** `src/QuickEntry.html` (–Ω–æ–≤—ã–π)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –°–æ–∑–¥–∞—Ç—å HTML —Ñ–∞–π–ª —Å —Ñ–æ—Ä–º–æ–π –≤–≤–æ–¥–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
2. –ü–æ–ª—è —Ñ–æ—Ä–º—ã:
   - –î–∞—Ç–∞ (date picker, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ–≥–æ–¥–Ω—è)
   - –¢–∏–ø (dropdown: expense, income, transfer)
   - –°—á–µ—Ç (dropdown, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ Accounts)
   - –°—á–µ—Ç –ø–æ–ª—É—á–∞—Ç–µ–ª—è (dropdown, —Ç–æ–ª—å–∫–æ –¥–ª—è transfer)
   - –°—É–º–º–∞ (number input)
   - –í–∞–ª—é—Ç–∞ (dropdown: RUB, USD, EUR)
   - –ö–∞—Ç–µ–≥–æ—Ä–∏—è (dropdown, –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ Categories)
   - –ü–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏—è (dropdown, –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)
   - –ú–µ—Ä—á–∞–Ω—Ç (text input)
   - –û–ø–∏—Å–∞–Ω–∏–µ (textarea)
3. –ö–Ω–æ–ø–∫–∏:
   - "–î–æ–±–∞–≤–∏—Ç—å" ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –∏ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–∞–π–¥–±–∞—Ä
   - "–î–æ–±–∞–≤–∏—Ç—å –∏ –µ—â–µ –æ–¥–Ω—É" ‚Äî –¥–æ–±–∞–≤–ª—è–µ—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –∏ –æ—á–∏—â–∞–µ—Ç —Ñ–æ—Ä–º—É
   - "–û—Ç–º–µ–Ω–∞" ‚Äî –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Å–∞–π–¥–±–∞—Ä

**UI/UX —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏ —á–∏—Å—Ç—ã–π –¥–∏–∑–∞–π–Ω
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ (JavaScript)
- –ü–æ–¥—Å–∫–∞–∑–∫–∏ –¥–ª—è –ø–æ–ª–µ–π
- –ê–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –≤–≤–æ–¥–µ Merchant/Description (–µ—Å–ª–∏ –≠—Ç–∞–ø 3 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω)

**JavaScript —Ñ—É–Ω–∫—Ü–∏–∏:**
- `loadAccounts()` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—á–µ—Ç–æ–≤
- `loadCategories()` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π
- `loadSubcategories(category)` ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç—å –ø–æ–¥–∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- `validateForm()` ‚Äî –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
- `handleSubmit()` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- `handleAddAndMore()` ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ –æ—á–∏—Å—Ç–∫–∞ —Ñ–æ—Ä–º—ã

**–°—Ç–∏–ª–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CSS –¥–ª—è —Å—Ç–∏–ª–∏–∑–∞—Ü–∏–∏
- –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π –¥–∏–∑–∞–π–Ω
- –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤–∞–ª–∏–¥–∞—Ü–∏–∏

---

### –ó–∞–¥–∞—á–∞ 6.2: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å QuickEntry.js

**–§–∞–π–ª:** `src/QuickEntry.js` (–Ω–æ–≤—ã–π)

**–§—É–Ω–∫—Ü–∏–∏:**

#### 6.2.1. `pfShowQuickEntry()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–∫—Ä—ã—Ç—å —Å–∞–π–¥–±–∞—Ä –±—ã—Å—Ç—Ä–æ–≥–æ –≤–≤–æ–¥–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –°–æ–∑–¥–∞—Ç—å HTML –∏–∑ `QuickEntry.html`
2. –û—Ç–æ–±—Ä–∞–∑–∏—Ç—å –∫–∞–∫ —Å–∞–π–¥–±–∞—Ä:
   ```javascript
   var html = HtmlService.createHtmlOutputFromFile('QuickEntry')
     .setTitle('–ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏')
     .setWidth(400);
   SpreadsheetApp.getUi().showSidebar(html);
   ```

---

#### 6.2.2. `pfGetAccountsForQuickEntry()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å—á–µ—Ç–æ–≤ –¥–ª—è dropdown

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Array<string>` ‚Äî –º–∞—Å—Å–∏–≤ –Ω–∞–∑–≤–∞–Ω–∏–π —Å—á–µ—Ç–æ–≤

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Accounts
2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –∫–æ–ª–æ–Ω–∫—É Account (–∏—Å–∫–ª—é—á–∞—è –∑–∞–≥–æ–ª–æ–≤–æ–∫)
3. –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ —Å—á–µ—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å –∫–æ–ª–æ–Ω–∫–∞ Active)
4. –í–µ—Ä–Ω—É—Ç—å –º–∞—Å—Å–∏–≤ –Ω–∞–∑–≤–∞–Ω–∏–π

---

#### 6.2.3. `pfGetCategoriesForQuickEntry()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–ª—è dropdown

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Array<string>` ‚Äî –º–∞—Å—Å–∏–≤ –Ω–∞–∑–≤–∞–Ω–∏–π –∫–∞—Ç–µ–≥–æ—Ä–∏–π

**–ê–ª–≥–æ—Ä–∏—Ç–º:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å—á–µ—Ç–∞–º

---

#### 6.2.4. `pfAddQuickTransaction_(data)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –∏–∑ —Ñ–æ—Ä–º—ã

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `data` (Object) ‚Äî –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã:
   ```javascript
   {
     date: string (ISO format),
     type: string,
     account: string,
     accountTo: string (optional),
     amount: number,
     currency: string,
     category: string (optional),
     subcategory: string (optional),
     merchant: string (optional),
     description: string (optional)
   }
   ```

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Object` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `{success: boolean, message: string, rowNum: number}`

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è: date, type, account, amount, currency
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ account —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–µ
   - –ï—Å–ª–∏ type = transfer ‚Üí –ø—Ä–æ–≤–µ—Ä–∏—Ç—å accountTo
2. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—é (–µ—Å–ª–∏ –≠—Ç–∞–ø 3 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω):
   - –ï—Å–ª–∏ category –Ω–µ —É–∫–∞–∑–∞–Ω–∞ ‚Üí –≤—ã–∑–≤–∞—Ç—å `pfApplyCategoryRules_()`
3. –°–æ–∑–¥–∞—Ç—å –æ–±—ä–µ–∫—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏:
   ```javascript
   {
     date: new Date(data.date),
     type: data.type,
     account: data.account,
     accountTo: data.accountTo,
     amount: data.amount,
     currency: data.currency,
     category: data.category,
     subcategory: data.subcategory,
     merchant: data.merchant,
     description: data.description,
     source: PF_IMPORT_SOURCE.MANUAL,
     status: PF_TRANSACTION_STATUS.OK
   }
   ```
4. –î–æ–±–∞–≤–∏—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –≤ –ª–∏—Å—Ç Transactions:
   - –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é —Å—Ç—Ä–æ–∫—É
   - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç –≤ row —á–µ—Ä–µ–∑ `pfTransactionDTOToRow_()`
   - –ó–∞–ø–∏—Å–∞—Ç—å –≤ –ª–∏—Å—Ç
5. –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—é —á–µ—Ä–µ–∑ `pfNormalizeTransactionRow_()` –∏ `pfValidateTransactionRow_()`
6. –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –í–∞–ª–∏–¥–∞—Ü–∏—è —á–µ—Ä–µ–∑ `pfCreateErrorResponse_()` –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `pfLogError_()`

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –¢–µ—Å—Ç —Å –≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –¢–µ—Å—Ç —Å –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
- –¢–µ—Å—Ç —Å transfer (–ø—Ä–æ–≤–µ—Ä–∫–∞ accountTo)
- –¢–µ—Å—Ç –∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏

---

### –ó–∞–¥–∞—á–∞ 6.3: –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é

**–§–∞–π–ª:** `src/Code.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç "–ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏" ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `pfShowQuickEntry()`

---

### –ó–∞–¥–∞—á–∞ 6.4: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–µ–π

**–§–∞–π–ª:** `src/QuickEntry.html` (JavaScript)

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–æ–ª–µ–π Merchant –∏–ª–∏ Description –≤—ã–∑—ã–≤–∞—Ç—å —Å–µ—Ä–≤–µ—Ä–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∞–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏
- –û–±–Ω–æ–≤–ª—è—Ç—å dropdown Category –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –î–æ–±–∞–≤–∏—Ç—å event listeners –Ω–∞ –ø–æ–ª—è merchant –∏ description
2. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤—ã–∑—ã–≤–∞—Ç—å `google.script.run.pfAutoCategorizeTransaction_()`
3. –û–±–Ω–æ–≤–∏—Ç—å dropdown category

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 6

- ‚úÖ –°–∞–π–¥–±–∞—Ä –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –∏–∑ –º–µ–Ω—é
- ‚úÖ –ú–æ–∂–Ω–æ –≤–≤–µ—Å—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ –ª–∏—Å—Ç Transactions
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω—è—é—Ç—Å—è)
- ‚úÖ –ê–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è (–µ—Å–ª–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞)
- ‚úÖ Dropdown –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–æ–≤
- ‚úÖ UI –ø–æ–Ω—è—Ç–Ω—ã–π –∏ —É–¥–æ–±–Ω—ã–π

---

## –≠—Ç–∞–ø 7: –≠–∫—Å–ø–æ—Ä—Ç –∏ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

**ID:** TASK-007  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –°—Ä–µ–¥–Ω–∏–π  
**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 7.1: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å Export.js

**–§–∞–π–ª:** `src/Export.js` (–Ω–æ–≤—ã–π)

**–§—É–Ω–∫—Ü–∏–∏:**

#### 7.1.1. `pfExportTransactions_(format)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –≠–∫—Å–ø–æ—Ä—Ç —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –≤ CSV –∏–ª–∏ JSON

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `format` (string) ‚Äî —Ñ–æ—Ä–º–∞—Ç: `'csv'` –∏–ª–∏ `'json'`

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Blob` ‚Äî —Ñ–∞–π–ª –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è

**–ê–ª–≥–æ—Ä–∏—Ç–º (CSV):**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Transactions
2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ (–≤–∫–ª—é—á–∞—è –∑–∞–≥–æ–ª–æ–≤–æ–∫)
3. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å:
   - –î–ª—è ru_RU –ª–æ–∫–∞–ª–∏: —Ç–æ—á–∫–∞ —Å –∑–∞–ø—è—Ç–æ–π `;`
   - –î–ª—è –¥—Ä—É–≥–∏—Ö: –∑–∞–ø—è—Ç–∞—è `,`
4. –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ CSV:
   - –≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–∞–≤—ã—á–∫–∏
   - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å –¥–∞—Ç—ã (—Ñ–æ—Ä–º–∞—Ç ISO –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω—ã–π)
   - –û–±—Ä–∞–±–æ—Ç–∞—Ç—å —á–∏—Å–ª–∞ (–ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
5. –°–æ–∑–¥–∞—Ç—å Blob:
   ```javascript
   var blob = Utilities.newBlob(csvContent, 'text/csv;charset=utf-8', 'transactions.csv');
   ```

**–ê–ª–≥–æ—Ä–∏—Ç–º (JSON):**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Transactions
2. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
3. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤:
   ```javascript
   var transactions = [];
   for (var i = 1; i < data.length; i++) {
     var tx = {};
     for (var j = 0; j < headers.length; j++) {
       tx[headers[j]] = data[i][j];
     }
     transactions.push(tx);
   }
   ```
4. –°–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ JSON:
   ```javascript
   var jsonContent = JSON.stringify(transactions, null, 2);
   ```
5. –°–æ–∑–¥–∞—Ç—å Blob:
   ```javascript
   var blob = Utilities.newBlob(jsonContent, 'application/json', 'transactions.json');
   ```

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –ª–∏—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω ‚Üí –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –≠–∫—Å–ø–æ—Ä—Ç –≤ CSV
- –≠–∫—Å–ø–æ—Ä—Ç –≤ JSON
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥–∏—Ä–æ–≤–∫—É (UTF-8)

---

#### 7.1.2. `pfExportAllData_(format)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –≠–∫—Å–ø–æ—Ä—Ç –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö (Transactions, Accounts, Categories)

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `format` (string) ‚Äî —Ñ–æ—Ä–º–∞—Ç: `'csv'` –∏–ª–∏ `'json'`

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Blob` ‚Äî ZIP –∞—Ä—Ö–∏–≤ —Å —Ñ–∞–π–ª–∞–º–∏

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –ª–∏—Å—Ç –æ—Ç–¥–µ–ª—å–Ω–æ
2. –°–æ–∑–¥–∞—Ç—å ZIP –∞—Ä—Ö–∏–≤ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Utilities.zip()`)
3. –í–µ—Ä–Ω—É—Ç—å Blob

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** ZIP –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω–æ –≤ Apps Script. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—ã–π –ª–∏—Å—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –∏–ª–∏ —Å–æ–∑–¥–∞—Ç—å –æ–¥–∏–Ω JSON —Å —Ä–∞–∑–Ω—ã–º–∏ —Å–µ–∫—Ü–∏—è–º–∏.

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
- –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ –æ–¥–∏–Ω JSON —Ñ–∞–π–ª —Å —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π:
   ```json
   {
     "transactions": [...],
     "accounts": [...],
     "categories": [...]
   }
   ```

---

#### 7.1.3. `pfCreateBackup_()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –ª–∏—Å—Ç–∞ Transactions

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:** –ù–µ—Ç

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Object` ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç: `{success: boolean, message: string, sheetName: string}`

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Transactions
2. –°–æ–∑–¥–∞—Ç—å –∏–º—è –¥–ª—è backup –ª–∏—Å—Ç–∞: `Transactions_Backup_YYYYMMDD`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ —É–∂–µ –ª–∏—Å—Ç —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º
4. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ª–∏—Å—Ç
5. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ:
   - –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ –∏ –∫–æ–ª–æ–Ω–∫–∏
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `copyTo()`)
6. –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –ª–∏—Å—Ç —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç ‚Üí –¥–æ–±–∞–≤–∏—Ç—å timestamp –∏–ª–∏ –Ω–æ–º–µ—Ä
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å –æ—à–∏–±–∫—É

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –°–æ–∑–¥–∞–Ω–∏–µ backup
- –ü—Ä–æ–≤–µ—Ä–∫–∞, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –¢–µ—Å—Ç —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º backup –ª–∏—Å—Ç–æ–º

---

### –ó–∞–¥–∞—á–∞ 7.2: –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç—ã –º–µ–Ω—é

**–§–∞–π–ª:** `src/Code.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–º–µ–Ω—é "–≠–∫—Å–ø–æ—Ä—Ç":
   ```javascript
   var exportMenu = ui.createMenu('–≠–∫—Å–ø–æ—Ä—Ç');
   exportMenu.addItem('–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (CSV)', 'pfExportTransactionsCSV');
   exportMenu.addItem('–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (JSON)', 'pfExportTransactionsJSON');
   exportMenu.addItem('–í—Å–µ –¥–∞–Ω–Ω—ã–µ (JSON)', 'pfExportAllDataJSON');
   exportMenu.addSeparator();
   exportMenu.addItem('–°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é', 'pfCreateBackup');
   ```

2. –°–æ–∑–¥–∞—Ç—å –ø—É–±–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏-–æ–±–µ—Ä—Ç–∫–∏:
   - `pfExportTransactionsCSV()` ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç `pfExportTransactions_('csv')` –∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç —Ñ–∞–π–ª
   - `pfExportTransactionsJSON()` ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è JSON
   - `pfExportAllDataJSON()` ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
   - `pfCreateBackup()` ‚Äî –≤—ã–∑—ã–≤–∞–µ—Ç `pfCreateBackup_()` –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°–∫–∞—á–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –≤ Apps Script –º–æ–∂–µ—Ç –±—ã—Ç—å —Å–ª–æ–∂–Ω—ã–º. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî –ø–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –¥–∏–∞–ª–æ–≥–µ –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DriveApp` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ñ–∞–π–ª–∞.

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥:**
- –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª –≤ Google Drive —á–µ—Ä–µ–∑ `DriveApp.createFile()`
- –ü–æ–∫–∞–∑–∞—Ç—å —Å—Å—ã–ª–∫—É –Ω–∞ —Ñ–∞–π–ª –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –ò–ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –¥–∏–∞–ª–æ–≥–µ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 7

- ‚úÖ –ú–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ CSV
- ‚úÖ –ú–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ JSON
- ‚úÖ –ú–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
- ‚úÖ –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã
- ‚úÖ Backup —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## –≠—Ç–∞–ø 8: –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä—ã

**ID:** TASK-008  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π  
**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 8.1: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å Search.js

**–§–∞–π–ª:** `src/Search.js` (–Ω–æ–≤—ã–π)

**–§—É–Ω–∫—Ü–∏–∏:**

#### 8.1.1. `pfSearchTransactions_(query)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∏—Å–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ —Ç–µ–∫—Å—Ç—É

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `query` (string) ‚Äî –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Array<Object>` ‚Äî –º–∞—Å—Å–∏–≤ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π:
   ```javascript
   [{
     rowNum: number,
     transaction: Object,
     matchField: string // 'merchant', 'description', 'category'
   }]
   ```

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å query (trim, lowercase)
2. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Transactions
3. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
4. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏:
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ –≤ –ø–æ–ª—è—Ö: Merchant, Description, Category
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `indexOf()` –¥–ª—è —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è (case-insensitive)
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –¥–æ–±–∞–≤–∏—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
5. –í–µ—Ä–Ω—É—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ query –ø—É—Å—Ç–æ–π ‚Üí –≤–µ—Ä–Ω—É—Ç—å –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –≤–µ—Ä–Ω—É—Ç—å –ø—É—Å—Ç–æ–π –º–∞—Å—Å–∏–≤

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ Transactions
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –±–æ–ª–µ–µ –≥–∏–±–∫–æ–≥–æ –ø–æ–∏—Å–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

#### 8.1.2. `pfShowSearchDialog_()`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –ø–æ–∏—Å–∫–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–∫–∞–∑–∞—Ç—å prompt –¥–ª—è –≤–≤–æ–¥–∞ –∑–∞–ø—Ä–æ—Å–∞
2. –í—ã–∑–≤–∞—Ç—å `pfSearchTransactions_()`
3. –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ (–ø–µ—Ä–≤—ã–µ 20)
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ ‚Üí –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ
4. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚Üí –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å—Ç—Ä–æ–∫–µ –≤ –ª–∏—Å—Ç–µ

**UI:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SpreadsheetApp.getUi().prompt()` –¥–ª—è –≤–≤–æ–¥–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `SpreadsheetApp.getUi().alert()` –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
- –ò–ª–∏ —Å–æ–∑–¥–∞—Ç—å HTML –¥–∏–∞–ª–æ–≥ –¥–ª—è –±–æ–ª–µ–µ —É–¥–æ–±–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

---

#### 8.1.3. `pfHighlightSearchResults_(results)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–æ–∫

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `results` (Array<Object>) ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–∏—Å–∫–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Transactions
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:
   - –ü–æ–¥—Å–≤–µ—Ç–∏—Ç—å —Å—Ç—Ä–æ–∫—É –∂–µ–ª—Ç—ã–º —Ü–≤–µ—Ç–æ–º
   - –î–æ–±–∞–≤–∏—Ç—å note —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏
3. –ü–µ—Ä–µ–π—Ç–∏ –∫ –ø–µ—Ä–≤–æ–π –Ω–∞–π–¥–µ–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–µ

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ —Å—Ç—Ä–æ–∫–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ ‚Üí –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å

---

### –ó–∞–¥–∞—á–∞ 8.2: –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é

**–§–∞–π–ª:** `src/Code.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç "–ù–∞–π—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏" ‚Üí –≤—ã–∑—ã–≤–∞–µ—Ç `pfShowSearchDialog_()`

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 8

- ‚úÖ –ú–æ–∂–Ω–æ –∏—Å–∫–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–æ —Ç–µ–∫—Å—Ç—É
- ‚úÖ –ù–∞–π–¥–µ–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—é—Ç—Å—è
- ‚úÖ –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∫ –Ω–∞–π–¥–µ–Ω–Ω–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ Merchant, Description, Category

---

## –≠—Ç–∞–ø 9: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏

**ID:** TASK-009  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π  
**–û—Ü–µ–Ω–∫–∞:** 3-4 —á–∞—Å–∞  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 9.1: –î–æ–±–∞–≤–∏—Ç—å line chart –¥–∏–Ω–∞–º–∏–∫–∏ –≤ Dashboard.js

**–§–∞–π–ª:** `src/Dashboard.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å line chart –ø–æ—Å–ª–µ pie chart
2. –î–∞–Ω–Ω—ã–µ: –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã –ø–æ –º–µ—Å—è—Ü–∞–º (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 12 –º–µ—Å—è—Ü–µ–≤)

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –º–µ—Å—è—á–Ω–æ–≥–æ cashflow (–∏–∑ Reports –∏–ª–∏ –≤—ã—á–∏—Å–ª–∏—Ç—å –∑–∞–Ω–æ–≤–æ)
2. –°–æ–∑–¥–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–Ω—ã—Ö:
   - –ö–æ–ª–æ–Ω–∫–∞ 1: –ú–µ—Å—è—Ü (–º–µ—Ç–∫–∞: "–Ø–Ω–≤ 2025")
   - –ö–æ–ª–æ–Ω–∫–∞ 2: –î–æ—Ö–æ–¥—ã
   - –ö–æ–ª–æ–Ω–∫–∞ 3: –†–∞—Å—Ö–æ–¥—ã
3. –°–æ–∑–¥–∞—Ç—å chart:
   ```javascript
   var chartBuilder = dashboardSheet.newChart()
     .setChartType(Charts.ChartType.LINE)
     .addRange(dataRange)
     .setPosition(chartRow, 1, 0, 0)
     .setOption('title', lang === 'en' ? 'Income and Expenses Trend' : '–î–∏–Ω–∞–º–∏–∫–∞ –¥–æ—Ö–æ–¥–æ–≤ –∏ —Ä–∞—Å—Ö–æ–¥–æ–≤')
     .setOption('legend', {position: 'bottom'})
     .setOption('hAxis', {title: lang === 'en' ? 'Month' : '–ú–µ—Å—è—Ü'})
     .setOption('vAxis', {title: lang === 'en' ? 'Amount' : '–°—É–º–º–∞'})
     .setOption('width', 600)
     .setOption('height', 400);
   var chart = chartBuilder.build();
   dashboardSheet.insertChart(chart);
   ```

**–î–µ—Ç–∞–ª–∏:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Å–µ–∫—Ü–∏–∏ "–ú–µ—Å—è—á–Ω—ã–π cashflow" –≤ Reports
- –ò–ª–∏ –≤—ã—á–∏—Å–ª–∏—Ç—å –∑–∞–Ω–æ–≤–æ (–µ—Å–ª–∏ Reports –Ω–µ –æ–±–Ω–æ–≤–ª–µ–Ω)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –¥–∞–Ω–Ω—ã—Ö

---

### –ó–∞–¥–∞—á–∞ 9.2: –î–æ–±–∞–≤–∏—Ç—å bar chart —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –≤ Dashboard.js

**–§–∞–π–ª:** `src/Dashboard.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å bar chart: —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º
2. –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Ö–æ–¥—ã –∏ —Ä–∞—Å—Ö–æ–¥—ã –¥–ª—è –æ–±–æ–∏—Ö –º–µ—Å—è—Ü–µ–≤

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –í—ã—á–∏—Å–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –∏ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞
2. –°–æ–∑–¥–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–Ω—ã—Ö:
   - –ö–æ–ª–æ–Ω–∫–∞ 1: –ú–µ—Ç–∫–∞ ("–¢–µ–∫—É—â–∏–π –º–µ—Å—è—Ü", "–ü—Ä–µ–¥—ã–¥—É—â–∏–π –º–µ—Å—è—Ü")
   - –ö–æ–ª–æ–Ω–∫–∞ 2: –î–æ—Ö–æ–¥—ã
   - –ö–æ–ª–æ–Ω–∫–∞ 3: –†–∞—Å—Ö–æ–¥—ã
3. –°–æ–∑–¥–∞—Ç—å chart:
   ```javascript
   var chartBuilder = dashboardSheet.newChart()
     .setChartType(Charts.ChartType.COLUMN)
     .addRange(dataRange)
     .setPosition(chartRow, 1, 0, 0)
     .setOption('title', lang === 'en' ? 'Month Comparison' : '–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –º–µ—Å—è—Ü–µ–≤')
     .setOption('legend', {position: 'bottom'})
     .setOption('width', 500)
     .setOption('height', 300);
   ```

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö

---

### –ó–∞–¥–∞—á–∞ 9.3: –î–æ–±–∞–≤–∏—Ç—å –∞–Ω–∞–ª–∏–∑ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏ –≤ Dashboard.js

**–§–∞–π–ª:** `src/Dashboard.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å bar chart: —Å—Ä–µ–¥–Ω–∏–µ —Ä–∞—Å—Ö–æ–¥—ã –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏
2. –ü–æ–∫–∞–∑–∞—Ç—å, –≤ –∫–∞–∫–∏–µ –¥–Ω–∏ –Ω–µ–¥–µ–ª–∏ —Ç—Ä–∞—Ç–∏—Ç—Å—è –±–æ–ª—å—à–µ

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Ç–µ–∫—É—â–µ–≥–æ –º–µ—Å—è—Ü–∞ (—Ç–∏–ø expense)
2. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å –ø–æ –¥–Ω—é –Ω–µ–¥–µ–ª–∏:
   - –î–ª—è –∫–∞–∂–¥–æ–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥–µ–Ω—å –Ω–µ–¥–µ–ª–∏ (1=–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫, 7=–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ)
   - –°—É–º–º–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥—ã –ø–æ –¥–Ω—è–º
   - –ü–æ–¥—Å—á–∏—Ç–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –ø–æ –¥–Ω—è–º
   - –í—ã—á–∏—Å–ª–∏—Ç—å —Å—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥: `total / count`
3. –°–æ–∑–¥–∞—Ç—å –¥–∏–∞–ø–∞–∑–æ–Ω –¥–∞–Ω–Ω—ã—Ö:
   - –ö–æ–ª–æ–Ω–∫–∞ 1: –î–µ–Ω—å –Ω–µ–¥–µ–ª–∏ ("–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–í—Ç–æ—Ä–Ω–∏–∫", ...)
   - –ö–æ–ª–æ–Ω–∫–∞ 2: –°—Ä–µ–¥–Ω–∏–π —Ä–∞—Å—Ö–æ–¥
4. –°–æ–∑–¥–∞—Ç—å chart (bar chart)

**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞—Å—á–µ—Ç —Å—Ä–µ–¥–Ω–∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
- –¢–µ—Å—Ç —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –¥–∞–Ω–Ω—ã—Ö

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 9

- ‚úÖ –í Dashboard –µ—Å—Ç—å line chart –¥–∏–Ω–∞–º–∏–∫–∏
- ‚úÖ –ï—Å—Ç—å bar chart —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–µ—Å—è—Ü–µ–≤
- ‚úÖ –ï—Å—Ç—å –∞–Ω–∞–ª–∏–∑ –ø–æ –¥–Ω—è–º –Ω–µ–¥–µ–ª–∏
- ‚úÖ –ì—Ä–∞—Ñ–∏–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è
- ‚úÖ –î–∞–Ω–Ω—ã–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–∞—Ö –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ

---

## –≠—Ç–∞–ø 10: –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**ID:** TASK-010  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π  
**–û—Ü–µ–Ω–∫–∞:** 2-3 —á–∞—Å–∞  
**–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:** –ù–µ—Ç

---

### –ó–∞–¥–∞—á–∞ 10.1: –°–æ–∑–¥–∞—Ç—å –º–æ–¥—É–ª—å Archive.js

**–§–∞–π–ª:** `src/Archive.js` (–Ω–æ–≤—ã–π)

**–§—É–Ω–∫—Ü–∏–∏:**

#### 10.1.1. `pfCreateArchiveSheet_(ss)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–Ω–∏–µ –ª–∏—Å—Ç–∞ –¥–ª—è –∞—Ä—Ö–∏–≤–∞

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ss` (Spreadsheet) ‚Äî —Ç–∞–±–ª–∏—Ü–∞

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Sheet` ‚Äî –ª–∏—Å—Ç –∞—Ä—Ö–∏–≤–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –ª–∏—Å—Ç `Transactions_Archive`
2. –ï—Å–ª–∏ –Ω–µ—Ç ‚Üí —Å–æ–∑–¥–∞—Ç—å
3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∏–∑ Transactions:
   - –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏
   - –ü—Ä–∏–º–µ–Ω–∏—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
4. –í–µ—Ä–Ω—É—Ç—å –ª–∏—Å—Ç

---

#### 10.1.2. `pfArchiveOldTransactions_(cutoffDate)`
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å—Ç–∞—Ä—à–µ —É–∫–∞–∑–∞–Ω–Ω–æ–π –¥–∞—Ç—ã

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `cutoffDate` (Date) ‚Äî –¥–∞—Ç–∞ –æ—Ç—Å–µ—á–∫–∏ (—Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å—Ç–∞—Ä—à–µ —ç—Ç–æ–π –¥–∞—Ç—ã –∞—Ä—Ö–∏–≤–∏—Ä—É—é—Ç—Å—è)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `Object` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: `{archived: number, errors: number}`

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Transactions
2. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Archive (—Å–æ–∑–¥–∞—Ç—å –µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
3. –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å `getLastRow()` –∏ –ø—Ä–æ—á–∏—Ç–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ
4. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ (–Ω–∞—á–∏–Ω–∞—è —Å–æ 2-–π):
   - –ü–æ–ª—É—á–∏—Ç—å –¥–∞—Ç—É —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
   - –ï—Å–ª–∏ –¥–∞—Ç–∞ < cutoffDate:
     - –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä–æ–∫—É –≤ Archive
     - –£–¥–∞–ª–∏—Ç—å —Å—Ç—Ä–æ–∫—É –∏–∑ Transactions (–∏–ª–∏ –ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ deleted)
5. –í–µ—Ä–Ω—É—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

**–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫:**
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å
- –ï—Å–ª–∏ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ ‚Üí –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç–Ω—É—é –æ–ø–µ—Ä–∞—Ü–∏—é –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `deleteRows()` –¥–ª—è –ø–∞–∫–µ—Ç–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç—Ä–æ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–º. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ ‚Äî –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ –∫–æ–Ω–µ—Ü –ª–∏—Å—Ç–∞ –∏ —Å–∫—Ä—ã—Ç—å, –∏–ª–∏ –ø–æ–º–µ—Ç–∏—Ç—å —Å—Ç–∞—Ç—É—Å–æ–º `deleted`.

---

#### 10.1.3. `pfRestoreFromArchive_(ss, startDate, endDate)` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π –∏–∑ –∞—Ä—Ö–∏–≤–∞

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `ss` (Spreadsheet) ‚Äî —Ç–∞–±–ª–∏—Ü–∞
- `startDate` (Date, optional) ‚Äî –Ω–∞—á–∞–ª—å–Ω–∞—è –¥–∞—Ç–∞
- `endDate` (Date, optional) ‚Äî –∫–æ–Ω–µ—á–Ω–∞—è –¥–∞—Ç–∞

**–ê–ª–≥–æ—Ä–∏—Ç–º:**
1. –ü–æ–ª—É—á–∏—Ç—å –ª–∏—Å—Ç Archive
2. –ù–∞–π—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤ —É–∫–∞–∑–∞–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–∞—Ç
3. –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –≤ Transactions
4. –£–¥–∞–ª–∏—Ç—å –∏–∑ Archive (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

### –ó–∞–¥–∞—á–∞ 10.2: –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç –º–µ–Ω—é

**–§–∞–π–ª:** `src/Code.js`

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø—É–Ω–∫—Ç "–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏"
2. –ü–æ–∫–∞–∑–∞—Ç—å –¥–∏–∞–ª–æ–≥ –¥–ª—è –≤—ã–±–æ—Ä–∞ –¥–∞—Ç—ã –æ—Ç—Å–µ—á–∫–∏
3. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–µ—Ä–µ–¥ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ–º

**UI:**
- Prompt –¥–ª—è –≤–≤–æ–¥–∞ –¥–∞—Ç—ã
- –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω—ã

---

### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –ø—Ä–∏–µ–º–∫–∏ (DoD) –¥–ª—è –≠—Ç–∞–ø–∞ 10

- ‚úÖ –ú–æ–∂–Ω–æ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- ‚úÖ –ê—Ä—Ö–∏–≤ —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º –ª–∏—Å—Ç–µ
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –≤ –∞—Ä—Ö–∏–≤
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —É–ª—É—á—à–∞–µ—Ç—Å—è (–º–µ–Ω—å—à–µ —Å—Ç—Ä–æ–∫ –≤ Transactions)

---

## –û–±—â–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤

### –ö–æ–¥
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–æ–¥—É–ª–∏: `Constants.js`, `ErrorHandler.js`, `DateUtils.js`, `Sheets.js`
- –°–ª–µ–¥–æ–≤–∞—Ç—å –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞
- –î–æ–±–∞–≤–ª—è—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å i18n –¥–ª—è –≤—Å–µ—Ö —Ç–µ–∫—Å—Ç–æ–≤
- JSDoc –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- Unit-—Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π (–¥–æ–±–∞–≤–∏—Ç—å –≤ `Tests.js`)
- –†—É—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ edge cases

### –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- –û–±–Ω–æ–≤–∏—Ç—å `PROJECT_STATE.md` –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞
- –û–±–Ω–æ–≤–∏—Ç—å `Help.js` —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏ –ø–æ –Ω–æ–≤—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º
- –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ö—ç—à–∏—Ä–æ–≤–∞—Ç—å `getLastRow()` –ø–µ—Ä–µ–¥ —Ü–∏–∫–ª–∞–º–∏
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–∞–∫–µ—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (`setValues()` –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö `setValue()`)
- –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (—á–∏—Ç–∞—Ç—å –æ–¥–∏–Ω —Ä–∞–∑, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ –ø–∞–º—è—Ç–∏)

---

## –ü–æ—Ä—è–¥–æ–∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π)

1. **–≠—Ç–∞–ø 1** (–ë—é–¥–∂–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ) ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–æ, –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å—Ç–æ
2. **–≠—Ç–∞–ø 2** (–†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏) ‚Äî –∫—Ä–∏—Ç–∏—á–Ω–æ, —Å—Ä–µ–¥–Ω—è—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å
3. **–≠—Ç–∞–ø 3** (–ê–≤—Ç–æ–∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è) ‚Äî –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∏—Ç UX
4. **–≠—Ç–∞–ø 5** (–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞) ‚Äî —É–ª—É—á—à–∏—Ç –∞–Ω–∞–ª–∏—Ç–∏–∫—É
5. **–≠—Ç–∞–ø 6** (–ë—ã—Å—Ç—Ä—ã–π –≤–≤–æ–¥) ‚Äî —É–ª—É—á—à–∏—Ç UX –¥–ª—è –Ω–æ–≤–∏—á–∫–æ–≤
6. **–≠—Ç–∞–ø 7** (–≠–∫—Å–ø–æ—Ä—Ç) ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
7. **–≠—Ç–∞–ø 4** (–ú—É–ª—å—Ç–∏–≤–∞–ª—é—Ç–Ω–æ—Å—Ç—å) ‚Äî –µ—Å–ª–∏ –Ω—É–∂–Ω–∞
8. –û—Å—Ç–∞–ª—å–Ω—ã–µ —ç—Ç–∞–ø—ã ‚Äî –ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏

---

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –í—Å–µ —ç—Ç–∞–ø—ã –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã –∏ –º–æ–≥—É—Ç —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å—Å—è –≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ñ–∏–∫—Å–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –ú–æ–∂–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —ç—Ç–∞–ø—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –Ω—É–∂–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
- –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ—Ç—Ä–µ–±–Ω–æ—Å—Ç–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
